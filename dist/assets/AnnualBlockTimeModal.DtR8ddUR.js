import{r as N,j as t}from"./index.8oJwqbgR.js";import"./react-vendor.CdglivQu.js";import"./firebase-vendor.CQY7ULBN.js";import"./utils-vendor.Dc4w0XSH.js";const _=({isOpen:u,onClose:v,flights:w,currentYear:k})=>{const[m,T]=N.useState([]),[B,M]=N.useState(!1);if(N.useEffect(()=>{if(!u)return;(async()=>{M(!0);try{const g=Array.from({length:12},(y,x)=>{const h=w.filter(o=>new Date(o.date).getFullYear()===k).filter(o=>new Date(o.date).getMonth()===x),r=h.find(o=>o.monthlyTotalBlock&&o.monthlyTotalBlock!=="00:00");let s=0;if(r&&r.monthlyTotalBlock){const o=r.monthlyTotalBlock.split(":");if(o.length===2){const d=parseInt(o[0])||0,f=parseInt(o[1])||0;s=d*60+f}}else s=h.reduce((o,d)=>d.block&&d.block>0?o+d.block:o,0);return{month:x,blockTime:s,monthName:`${x+1}월`,source:"Flight Data"}});T(g)}catch{T([])}finally{M(!1)}})()},[u,k,w]),!u)return null;let $=0;const p=m.map(n=>($+=n.blockTime,{...n,cumulativeTime:$}));Math.max(...m.map(n=>n.blockTime),100),Math.max(...p.map(n=>n.cumulativeTime),1e3);const L=()=>{const n=window.innerWidth>=768&&window.innerWidth<1024,g=window.innerWidth>=1024;let y,x,e,h;g?(y=160,x=110,e=12,h=16):n?(y=140,x=100,e=11,h=14):(y=120,x=95,e=10,h=13);const r=y-e-h,s=x-e*2,o=m.map((i,a)=>{const l=e+a*r/12+r/12/2,c=e+s-i.blockTime/6e3*s;return`${l},${c}`}).join(" "),d=m.map((i,a)=>{const l=e+a*r/12+r/12/2,c=isNaN(i.blockTime)?0:i.blockTime,b=e+s-c/6e3*s;return`${l},${b}`}).join(" "),f=d?`${d} L${e+r-r/12/2},${e+s} L${e+r/12/2},${e+s} Z`:"",W=m.map((i,a)=>{const l=e+a*r/12+r/12/2,c=e+s-i.blockTime/6e3*s;return t.jsx("circle",{cx:l,cy:c,r:1.2,fill:"#8B5CF6",className:"dark:fill-purple-400",stroke:"white",strokeWidth:.3},`monthly-point-${a}`)}),D=p.map((i,a)=>{const l=i.cumulativeTime/6e4*s,c=e+a*r/12+r/12/2-2.5,b=e+s-l;return t.jsx("rect",{x:c,y:b,width:5,height:l,fill:"url(#barGradient)",rx:1,ry:1},`cumulative-bar-${a}`)}),j=e+s-6e4/(1e3*60)*s,C=t.jsx("line",{x1:e,y1:j,x2:e+r,y2:j,stroke:"#EF4444",strokeWidth:.4,strokeDasharray:"0.8,0.8"}),F=t.jsx("text",{x:e+r-1,y:j-.5,fill:"#EF4444",fontSize:"3.4",fontWeight:"bold",textAnchor:"end",children:"LIMIT"}),A=Array.from({length:6},(i,a)=>{const l=1200*a,c=e+s-l/6e3*s;return t.jsxs("text",{x:e-1,y:c+1.2,fill:"#374151",className:"dark:fill-gray-200",fontSize:"3.4",fontWeight:"500",textAnchor:"end",children:[Math.round(l/60),"h"]},`left-y-${a}`)}),G=Array.from({length:6},(i,a)=>{const l=12e3*a,c=e+s-l/(1e3*60)*s;return t.jsxs("text",{x:e+r+2,y:c+1.2,fill:"#374151",className:"dark:fill-gray-200",fontSize:"3.4",fontWeight:"500",textAnchor:"start",children:[Math.round(l/60),"h"]},`right-y-${a}`)}),I=m.map((i,a)=>{const l=e+a*r/12+r/12/2;return t.jsx("text",{x:l,y:e+s+8,fill:"#374151",className:"dark:fill-gray-200",fontSize:"3.8",fontWeight:"500",textAnchor:"middle",children:i.monthName},`x-${a}`)}),P=Array.from({length:6},(i,a)=>{const l=e+s/5*a;return t.jsx("line",{x1:e,y1:l,x2:e+r,y2:l,stroke:"#D1D5DB",className:"dark:stroke-gray-600",strokeWidth:.2},`grid-${a}`)});return t.jsxs("svg",{viewBox:`0 0 ${y} ${x}`,className:"w-full h-full",preserveAspectRatio:"xMidYMid meet",children:[t.jsxs("defs",{children:[t.jsxs("linearGradient",{id:"areaGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[t.jsx("stop",{offset:"0%",stopColor:"#8B5CF6",stopOpacity:"0.3"}),t.jsx("stop",{offset:"100%",stopColor:"#8B5CF6",stopOpacity:"0.05"})]}),t.jsxs("linearGradient",{id:"lineGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[t.jsx("stop",{offset:"0%",stopColor:"#3B82F6"}),t.jsx("stop",{offset:"50%",stopColor:"#8B5CF6"}),t.jsx("stop",{offset:"100%",stopColor:"#EC4899"})]}),t.jsxs("linearGradient",{id:"barGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[t.jsx("stop",{offset:"0%",stopColor:"#10B981"}),t.jsx("stop",{offset:"100%",stopColor:"#059669"})]})]}),P,A,G,I,D,f&&t.jsx("path",{d:`M${f}`,fill:"url(#areaGradient)"}),t.jsx("polyline",{points:o,fill:"none",stroke:"url(#lineGradient)",strokeWidth:1.2,strokeLinecap:"round",strokeLinejoin:"round"}),W,C,F,t.jsx("line",{x1:e,y1:e,x2:e,y2:e+s,stroke:"#374151",className:"dark:stroke-gray-300",strokeWidth:.3}),t.jsx("line",{x1:e,y1:e+s,x2:e+r,y2:e+s,stroke:"#374151",className:"dark:stroke-gray-300",strokeWidth:.3}),t.jsx("line",{x1:e+r,y1:e,x2:e+r,y2:e+s,stroke:"#374151",className:"dark:stroke-gray-300",strokeWidth:.3})]})};return t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center z-50 px-0.5 sm:px-1 py-1 sm:py-2 pt-12 sm:pt-16 pt-safe",onClick:v,children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-4xl w-full max-h-[85vh] sm:max-h-[90vh] overflow-hidden",onClick:n=>n.stopPropagation(),children:[t.jsxs("div",{className:"flex items-center justify-between p-3 sm:p-4 border-b border-gray-200 dark:border-gray-700",children:[t.jsxs("h2",{className:"text-xl font-bold text-gray-800 dark:text-gray-200",children:[k,"년 연간 비행시간"]}),t.jsx("button",{onClick:v,className:"p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors",children:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsxs("div",{className:"p-3 pb-2",children:[t.jsx("div",{className:"mb-3",children:t.jsxs("div",{className:"flex items-center justify-end gap-4 text-sm",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-3 h-3 rounded-full bg-purple-500"}),t.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"월 시간"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 bg-green-500 opacity-70"}),t.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"누적 시간"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-4 h-1 bg-red-500 border-dashed border-t-2"}),t.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"1000시간 LIMIT"})]})]})}),t.jsx("div",{className:"p-1 sm:p-2",children:t.jsx("div",{className:"w-full h-[300px] sm:h-[340px] md:h-[380px] lg:h-[420px] overflow-x-auto",children:B?t.jsx("div",{className:"flex items-center justify-center h-full",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-500 mx-auto mb-2"}),t.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"월별 비행시간 불러오는 중..."})]})}):L()})})]}),t.jsx("div",{className:"px-3 pb-4 pt-2 border-t border-gray-200 dark:border-gray-700",children:t.jsxs("div",{className:"flex flex-row justify-between items-center gap-1 md:gap-2 text-xs md:text-base",children:[t.jsxs("div",{className:"flex items-center gap-1 md:gap-2",children:[t.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"최대:"}),t.jsxs("span",{className:"font-bold text-gray-800 dark:text-gray-200 text-sm md:text-lg",children:[Math.round(Math.max(...m.map(n=>n.blockTime))/60),"시간"]})]}),t.jsxs("div",{className:"flex items-center gap-1 md:gap-2",children:[t.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"총계:"}),t.jsxs("span",{className:"font-bold text-gray-800 dark:text-gray-200 text-sm md:text-lg",children:[Math.round((p[p.length-1]?.cumulativeTime||0)/60),"시간"]})]}),t.jsxs("div",{className:"flex items-center gap-1 md:gap-2",children:[t.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"LIMIT까지:"}),t.jsxs("span",{className:"font-bold text-gray-800 dark:text-gray-200 text-sm md:text-lg",children:[Math.max(0,1e3-Math.round((p[p.length-1]?.cumulativeTime||0)/60)),"시간"]})]})]})})]})})};export{_ as default};
//# sourceMappingURL=AnnualBlockTimeModal.DtR8ddUR.js.map
