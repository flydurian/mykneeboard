{"version":3,"file":"CurrencyDetailModal.BpZH07qU.js","sources":["../../components/modals/CurrencyDetailModal.tsx"],"sourcesContent":["import React from 'react';\nimport { CurrencyModalData, Flight } from '../../types';\nimport { XIcon } from '../icons';\nimport { isActualFlight } from '../../utils/helpers';\n\ninterface CurrencyDetailModalProps {\n    data: CurrencyModalData | null;\n    onClose: () => void;\n    onFlightClick: (flight: Flight) => void;\n}\n\nconst CurrencyDetailModal: React.FC<CurrencyDetailModalProps> = ({ data, onClose, onFlightClick }) => {\n    if (!data) return null;\n\n    // 월별 횟수 계산 (이륙/착륙 구분) - 6개월 데이터 사용\n    const calculateMonthlyData = () => {\n        const monthlyCount: { [key: string]: number } = {};\n        \n        // graphEvents가 있으면 사용, 없으면 events 사용 (호환성)\n        const eventsToUse = data.graphEvents || data.events;\n        \n        eventsToUse.forEach(event => {\n            // 이륙 이력에는 이륙만, 착륙 이력에는 착륙만 포함\n            const isTakeoffModal = data.title === '이륙';\n            const shouldInclude = isTakeoffModal ? event.status.departed : event.status.landed;\n            \n            if (shouldInclude) {\n                const date = new Date(event.date);\n                const monthKey = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}`;\n                monthlyCount[monthKey] = (monthlyCount[monthKey] || 0) + 1;\n            }\n        });\n\n        // 최근 6개월 데이터만 가져오기\n        const last6Months = [];\n        const now = new Date();\n        for (let i = 5; i >= 0; i--) {\n            const date = new Date(now.getFullYear(), now.getMonth() - i, 1);\n            const monthKey = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}`;\n            last6Months.push({\n                month: monthKey,\n                count: monthlyCount[monthKey] || 0,\n                displayMonth: `${date.getMonth() + 1}월`\n            });\n        }\n\n        return last6Months;\n    };\n\n    const monthlyData = calculateMonthlyData();\n    const maxCount = Math.max(...monthlyData.map(d => d.count), 1);\n\n    // 선형 그래프 생성\n    const createLineChart = () => {\n        const width = 300;\n        const height = 140;\n        const padding = 30;\n        const chartWidth = width - padding * 2;\n        const chartHeight = height - padding * 2;\n\n        if (monthlyData.length === 0) return null;\n\n        // 점들의 좌표 계산\n        const points = monthlyData.map((data, index) => {\n            const x = padding + (index * chartWidth) / (monthlyData.length - 1);\n            const y = padding + chartHeight - (data.count / maxCount) * chartHeight;\n            return { x, y, count: data.count };\n        });\n\n        // 선 경로 생성\n        const pathData = points.map((point, index) => \n            `${index === 0 ? 'M' : 'L'} ${point.x} ${point.y}`\n        ).join(' ');\n\n        // 영역 채우기 경로 생성\n        const areaPath = `${pathData} L ${points[points.length - 1].x} ${padding + chartHeight} L ${points[0].x} ${padding + chartHeight} Z`;\n\n        return (\n            <div className=\"mb-6\">\n                <div className=\"flex items-center justify-between mb-3\">\n                    <h3 className=\"text-sm font-semibold text-gray-700 dark:text-gray-300\">월별횟수(최근6개월)</h3>\n                    <div className=\"flex items-center space-x-2\">\n                        <div className=\"w-3 h-3 bg-gradient-to-r from-blue-400 to-purple-500 rounded-full\"></div>\n                        <span className=\"text-xs text-gray-500 dark:text-gray-400\">{data.title}</span>\n                    </div>\n                </div>\n                \n                <div className=\"relative\">\n                    <svg width={width} height={height} className=\"mx-auto drop-shadow-sm\">\n                        {/* 그라데이션 정의 */}\n                        <defs>\n                            <linearGradient id=\"lineGradient\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"0%\">\n                                <stop offset=\"0%\" stopColor=\"#3B82F6\" />\n                                <stop offset=\"50%\" stopColor=\"#8B5CF6\" />\n                                <stop offset=\"100%\" stopColor=\"#EC4899\" />\n                            </linearGradient>\n                            <linearGradient id=\"areaGradient\" x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\">\n                                <stop offset=\"0%\" stopColor=\"#3B82F6\" stopOpacity=\"0.3\" />\n                                <stop offset=\"100%\" stopColor=\"#3B82F6\" stopOpacity=\"0.05\" />\n                            </linearGradient>\n                            <filter id=\"glow\">\n                                <feGaussianBlur stdDeviation=\"3\" result=\"coloredBlur\"/>\n                                <feMerge> \n                                    <feMergeNode in=\"coloredBlur\"/>\n                                    <feMergeNode in=\"SourceGraphic\"/>\n                                </feMerge>\n                            </filter>\n                        </defs>\n\n                        {/* 배경 그리드 */}\n                        {[0, 1, 2, 3, 4].map(i => (\n                            <line\n                                key={i}\n                                x1={padding}\n                                y1={padding + (i * chartHeight) / 4}\n                                x2={width - padding}\n                                y2={padding + (i * chartHeight) / 4}\n                                stroke=\"currentColor\"\n                                strokeWidth=\"0.5\"\n                                strokeDasharray=\"2,2\"\n                                className=\"text-gray-200 dark:text-gray-700\"\n                            />\n                        ))}\n                        \n                        {/* 영역 채우기 */}\n                        <path\n                            d={areaPath}\n                            fill=\"url(#areaGradient)\"\n                        />\n                        \n                        {/* 선 그래프 */}\n                        <path\n                            d={pathData}\n                            fill=\"none\"\n                            stroke=\"url(#lineGradient)\"\n                            strokeWidth=\"3\"\n                            strokeLinecap=\"round\"\n                            strokeLinejoin=\"round\"\n                            filter=\"url(#glow)\"\n                        />\n                        \n                        {/* 점들 */}\n                        {points.map((point, index) => (\n                            <g key={index}>\n                                {/* 메인 점 */}\n                                <circle\n                                    cx={point.x}\n                                    cy={point.y}\n                                    r=\"5\"\n                                    fill=\"white\"\n                                    stroke=\"url(#lineGradient)\"\n                                    strokeWidth=\"2\"\n                                    className=\"drop-shadow-md\"\n                                />\n                                {/* 내부 점 */}\n                                <circle\n                                    cx={point.x}\n                                    cy={point.y}\n                                    r=\"2\"\n                                    fill=\"url(#lineGradient)\"\n                                />\n                                {/* 횟수 표시 */}\n                                <text\n                                    x={point.x}\n                                    y={point.y - 12}\n                                    textAnchor=\"middle\"\n                                    className=\"text-xs font-semibold fill-current text-gray-700 dark:text-gray-200\"\n                                >\n                                    {point.count}\n                                </text>\n                            </g>\n                        ))}\n                        \n                        {/* X축 라벨 */}\n                        {monthlyData.map((data, index) => (\n                            <text\n                                key={index}\n                                x={padding + (index * chartWidth) / (monthlyData.length - 1)}\n                                y={height - 8}\n                                textAnchor=\"middle\"\n                                className=\"text-xs font-medium fill-current text-gray-500 dark:text-gray-400\"\n                            >\n                                {data.displayMonth}\n                            </text>\n                        ))}\n                    </svg>\n                    \n                    {/* 통계 정보 */}\n                    <div className=\"mt-3 flex justify-between text-xs text-gray-500 dark:text-gray-400\">\n                        <span>최대: {maxCount}회</span>\n                        <span>총계: {monthlyData.reduce((sum, d) => sum + d.count, 0)}회</span>\n                    </div>\n                </div>\n            </div>\n        );\n    };\n\n    return (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex justify-center items-center z-50 p-4 pt-safe\" onClick={onClose}>\n            <div className=\"bg-white dark:bg-gray-800 rounded-2xl shadow-xl w-full max-w-md p-6 relative animate-fade-in-up\" onClick={(e) => e.stopPropagation()}>\n                <button onClick={onClose} className=\"absolute top-4 right-4 text-gray-400 dark:text-gray-300\">\n                    <XIcon className=\"w-6 h-6\" />\n                </button>\n                <h2 className=\"text-xl font-bold text-gray-900 dark:text-gray-100 mb-4\">{data.title} 최근 이력</h2>\n                \n                {/* 디버깅 로그 */}\n                \n                {data.events.length > 0 ? (\n                    <>\n                        {/* 월별 그래프 */}\n                        {createLineChart()}\n                        \n                        {/* 최근 이력 목록 */}\n                        <div>\n                            <h3 className=\"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2\">최근 기록</h3>\n                            <ul className=\"space-y-2\">\n                                {data.events\n                                    .sort((a, b) => {\n                                        // 먼저 날짜로 정렬 (최신 날짜가 위로)\n                                        const dateCompare = new Date(b.date).getTime() - new Date(a.date).getTime();\n                                        if (dateCompare !== 0) return dateCompare;\n                                        \n                                        // 같은 날짜인 경우 출발 시간으로 정렬 (최신 시간이 위로)\n                                        if (a.departureDateTimeUtc && b.departureDateTimeUtc) {\n                                            return new Date(b.departureDateTimeUtc).getTime() - new Date(a.departureDateTimeUtc).getTime();\n                                        }\n                                        \n                                        // 출발 시간이 없는 경우 편명으로 정렬 (숫자가 큰 편명이 위로)\n                                        const aFlightNum = parseInt(a.flightNumber.replace(/\\D/g, '')) || 0;\n                                        const bFlightNum = parseInt(b.flightNumber.replace(/\\D/g, '')) || 0;\n                                        return bFlightNum - aFlightNum;\n                                    })\n                                    .slice(0, 3)\n                                    .map(event => (\n                                    <li \n                                        key={event.id} \n                                        className=\"p-1.5 bg-gray-50 dark:bg-gray-700/50 rounded-lg cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600/50 transition-colors\"\n                                        onClick={() => onFlightClick(event)}\n                                    >\n                                        <p className=\"font-semibold text-gray-800 dark:text-gray-200\">{event.date}</p>\n                                        <p className=\"text-base text-gray-600 dark:text-gray-400\">\n                                            {event.flightNumber}편: {\n                                                event.route \n                                                    ? event.route.replace('/', ' → ')\n                                                    : isActualFlight(event)\n                                                        ? '노선 정보 없음'\n                                                        : event.flightNumber\n                                            }\n                                        </p>\n                                    </li>\n                                ))}\n                            </ul>\n                        </div>\n                    </>\n                ) : (\n                    <p className=\"text-gray-500 dark:text-gray-400\">최근 90일 내 기록이 없습니다.</p>\n                )}\n            </div>\n        </div>\n    );\n};\n\nexport default CurrencyDetailModal;"],"names":["CurrencyDetailModal","data","onClose","onFlightClick","monthlyData","monthlyCount","event","date","monthKey","last6Months","now","i","maxCount","d","createLineChart","points","index","x","y","pathData","point","areaPath","jsxs","jsx","sum","e","XIcon","Fragment","a","b","dateCompare","aFlightNum","isActualFlight"],"mappings":"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"}