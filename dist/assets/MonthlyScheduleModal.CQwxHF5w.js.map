{"version":3,"file":"MonthlyScheduleModal.CQwxHF5w.js","sources":["../../components/modals/MonthlyScheduleModal.tsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\nimport { MonthlyModalData, Flight } from '../../types';\nimport { XIcon } from '../icons';\nimport { isActualFlight } from '../../utils/helpers';\nimport { formatInTimeZone } from 'date-fns-tz';\n\ninterface MonthlyScheduleModalProps {\n    data: MonthlyModalData | null;\n    onClose: () => void;\n    onFlightClick: (flight: Flight) => void;\n    onMonthChange: (month: number) => void;\n    onStatusChange?: (flightId: string, status: Partial<{ departed: boolean; landed: boolean }>) => void;\n    userInfo?: { displayName: string | null; empl?: string; userName?: string; company?: string } | null;\n}\n\n// 공항별 타임존 매핑\nconst getAirportTimeZone = (airportCode: string): string => {\n    const timezoneMap: { [key: string]: string } = {\n        'ICN': 'Asia/Seoul',\n        'FCO': 'Europe/Rome',\n        'TPE': 'Asia/Taipei',\n        'JFK': 'America/New_York',\n        'SFO': 'America/Los_Angeles',\n        'LAX': 'America/Los_Angeles',\n        'NRT': 'Asia/Tokyo',\n        'HND': 'Asia/Tokyo',\n        'LHR': 'Europe/London',\n        'CDG': 'Europe/Paris',\n        'FRA': 'Europe/Berlin',\n        'SIN': 'Asia/Singapore',\n        'HKG': 'Asia/Hong_Kong',\n        'BKK': 'Asia/Bangkok',\n        'KUL': 'Asia/Kuala_Lumpur',\n        'MNL': 'Asia/Manila',\n        'HNL': 'Pacific/Honolulu',\n        'YVR': 'America/Vancouver',\n        'YYZ': 'America/Toronto',\n        'SYD': 'Australia/Sydney',\n        'MEL': 'Australia/Melbourne',\n        'AKL': 'Pacific/Auckland'\n    };\n    return timezoneMap[airportCode] || 'Asia/Seoul'; // 기본값은 서울\n};\n\nconst MonthlyScheduleModal: React.FC<MonthlyScheduleModalProps> = ({ data, onClose, onFlightClick, onMonthChange, onStatusChange, userInfo }) => {\n    const [showScrollbar, setShowScrollbar] = useState(false);\n    const scrollTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n    const [localFlights, setLocalFlights] = useState<Flight[]>([]);\n    \n    // data가 변경될 때마다 localFlights 업데이트\n    useEffect(() => {\n        if (data && data.flights) {\n            setLocalFlights(data.flights);\n        }\n    }, [data]);\n    \n    if (!data) {\n        return null;\n    }\n    \n    const { month, flights, blockTime } = data;\n    const flightsToUse = localFlights.length > 0 ? localFlights : flights;\n    \n    // 중복 제거: 같은 ID를 가진 비행 데이터 중복 제거\n    const uniqueFlights = flightsToUse.reduce((acc, current) => {\n        const existingIndex = acc.findIndex(flight => flight.id === current.id);\n        if (existingIndex === -1) {\n            acc.push(current);\n        }\n        return acc;\n    }, [] as Flight[]);\n\n\n    // 시간 순 정렬: 날짜와 STD 시간 기준으로 정렬\n    const sortedFlights = uniqueFlights.sort((a, b) => {\n        // 날짜 비교\n        const dateA = new Date(a.date);\n        const dateB = new Date(b.date);\n        \n        if (dateA.getTime() !== dateB.getTime()) {\n            return dateA.getTime() - dateB.getTime();\n        }\n        \n        // 같은 날짜인 경우 STD 시간으로 정렬\n        const stdA = a.std || '00:00';\n        const stdB = b.std || '00:00';\n        \n        // 시간 형식 변환 (HHMM -> HH:MM)\n        const formatTime = (time: string) => {\n            if (time.includes(':')) return time;\n            if (time.length === 4) {\n                return `${time.substring(0, 2)}:${time.substring(2, 4)}`;\n            }\n            return time;\n        };\n        \n        const formattedStdA = formatTime(stdA);\n        const formattedStdB = formatTime(stdB);\n        \n        return formattedStdA.localeCompare(formattedStdB);\n    });\n\n    // 현재 날짜를 기준으로 '이번 달' 또는 '지난 달'인지 확인하는 로직 추가\n    const today = new Date();\n    const currentDisplayYear = sortedFlights.length > 0 ? new Date(sortedFlights[0].date).getFullYear() : 0;\n    const isCurrentMonthSchedule = today.getFullYear() === currentDisplayYear && today.getMonth() === month;\n    const isPastMonthSchedule = today.getFullYear() === currentDisplayYear && today.getMonth() > month;\n    const shouldShowTakeoffLandingButtons = isCurrentMonthSchedule || isPastMonthSchedule;\n\n    // 오늘 날짜인지 확인하는 함수 (기기 현지 시간대 기준 문자열 비교)\n    const deviceTimeZone = Intl.DateTimeFormat().resolvedOptions().timeZone || 'UTC';\n    const todayLocalStr = formatInTimeZone(new Date(), deviceTimeZone, 'yyyy-MM-dd');\n    const isToday = (flightDate: string) => {\n        // flightDate는 출발지 현지 날짜 문자열(YYYY-MM-DD)\n        // 기기 현지 날짜 문자열과 동일하면 오늘로 간주하여 파란 막대 표시\n        return flightDate === todayLocalStr;\n    };\n\n    // KE 스케줄인지 확인 (A/C TYPE 정보가 있는 비행편이 있는지 체크)\n    const isKESchedule = sortedFlights.some(flight => flight.acType);\n\n    const handleFlightClick = (flight: Flight) => {\n        onFlightClick(flight);\n    };\n\n    const handlePreviousMonth = () => {\n        const newMonth = month === 0 ? 11 : month - 1;\n        onMonthChange(newMonth);\n    };\n\n    const handleNextMonth = () => {\n        const newMonth = month === 11 ? 0 : month + 1;\n        onMonthChange(newMonth);\n    };\n\n    // 스크롤 이벤트 핸들러\n    const handleScroll = (e: React.UIEvent<HTMLDivElement>) => {\n        setShowScrollbar(true);\n        \n        if (scrollTimeoutRef.current) {\n            clearTimeout(scrollTimeoutRef.current);\n        }\n        \n        scrollTimeoutRef.current = setTimeout(() => {\n            setShowScrollbar(false);\n        }, 1000);\n    };\n\n    // 업로드 변경 날짜 리스트 불러오기 (내용 기반 비교 결과)\n    let changedDatesPayload: { at: string, dates: string[] } | null = null;\n    try {\n        const raw = localStorage.getItem('last_upload_changed_dates');\n        if (raw) changedDatesPayload = JSON.parse(raw);\n    } catch {}\n    const changedDatesSet = new Set<string>(changedDatesPayload?.dates || []);\n\n    // 특정 날짜 그룹이 변경된 날짜인지 판단\n    const hasRecentChange = (flightsForDate: Flight[]) => {\n        if (changedDatesSet.size === 0) return false;\n        const dateKey = flightsForDate[0]?.date;\n        if (!dateKey) return false;\n        return changedDatesSet.has(dateKey);\n    };\n\n    return (\n        <>\n            <div className=\"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex justify-center items-center z-50 p-4 pt-safe\" onClick={onClose}>\n                <div className=\"bg-white dark:bg-gray-800 rounded-2xl shadow-xl w-full max-w-lg md:max-w-4xl lg:max-w-5xl xl:max-w-6xl p-6 relative animate-fade-in-up flex flex-col max-h-[85vh]\" onClick={(e) => e.stopPropagation()}>\n                    {/* 헤더 영역 */}\n                    <div className=\"flex items-center justify-between mb-4\">\n                        {/* 제목 */}\n                        <h2 className=\"text-xl font-bold text-gray-900 dark:text-gray-100\">\n                            {month + 1}월 스케줄\n                            <span className=\"text-base font-medium text-gray-500 dark:text-gray-400 ml-2\">\n                                (총 {blockTime})\n                            </span>\n                        </h2>\n                        \n                        {/* 네비게이션 및 닫기 버튼들 */}\n                        <div className=\"flex items-center space-x-1\">\n                            <button \n                                onClick={handlePreviousMonth}\n                                className=\"p-1 text-gray-400 dark:text-gray-300 hover:text-gray-600 dark:hover:text-gray-100 transition-colors\"\n                                title=\"이전 월\"\n                            >\n                                <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 19l-7-7 7-7\" />\n                                </svg>\n                            </button>\n                            <button \n                                onClick={handleNextMonth}\n                                className=\"p-1 text-gray-400 dark:text-gray-300 hover:text-gray-600 dark:hover:text-gray-100 transition-colors\"\n                                title=\"다음 월\"\n                            >\n                                <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 5l7 7-7 7\" />\n                                </svg>\n                            </button>\n                            <button \n                                onClick={onClose} \n                                className=\"p-1 text-gray-400 dark:text-gray-300 hover:text-gray-600 dark:hover:text-gray-100 transition-colors\"\n                                title=\"닫기\"\n                            >\n                                <XIcon className=\"w-5 h-5\" />\n                            </button>\n                        </div>\n                    </div>\n                    \n                    <div \n                        className={`flex-grow overflow-auto ${showScrollbar ? 'scrollbar-show' : 'scrollbar-hide'}`}\n                        onScroll={handleScroll}\n                    >\n                        {flights.length > 0 ? (\n                            <table className={`text-center w-full ${isKESchedule ? 'text-xs md:text-sm lg:text-base' : 'text-sm md:text-base'}`}>\n                                <thead className=\"text-xs font-semibold text-gray-800 dark:text-gray-300 uppercase bg-gray-50 dark:bg-gray-700 sticky top-0 z-10\">\n                                    <tr>\n                                        <th className={`${isKESchedule ? 'px-2 py-1 md:px-3 md:py-2 lg:px-4' : 'px-4 py-2'} whitespace-nowrap`}>날짜</th>\n                                        <th className={`${isKESchedule ? 'px-2 py-1 md:px-3 md:py-2 lg:px-4' : 'px-4 py-2'} whitespace-nowrap`}>편명</th>\n                                        <th className={`${isKESchedule ? 'px-2 py-1 md:px-3 md:py-2 lg:px-4' : 'px-4 py-2'} whitespace-nowrap`}>노선</th>\n                                        {/* KE 스케줄에만 A/C TYPE 컬럼 표시 */}\n                                        {isKESchedule && (\n                                            <th className=\"px-2 py-1 md:px-3 md:py-2 lg:px-4\">\n                                                <div className=\"text-xs md:text-sm\">\n                                                    <div>A/C</div>\n                                                    <div>TYPE</div>\n                                                </div>\n                                            </th>\n                                        )}\n                                        {/* md(768px) 이상 화면에서만 보이도록 수정 */}\n                                        <th className=\"px-4 py-2 md:px-3 md:py-2 lg:px-4 whitespace-nowrap hidden md:table-cell\">SHOW UP</th>\n                                        <th className=\"px-4 py-2 md:px-3 md:py-2 lg:px-4 whitespace-nowrap hidden md:table-cell\">STD</th>\n                                        <th className=\"px-4 py-2 md:px-3 md:py-2 lg:px-4 whitespace-nowrap hidden md:table-cell\">STA</th>\n                                        {shouldShowTakeoffLandingButtons && (\n                                            <th className=\"px-4 py-2 md:px-3 md:py-2 lg:px-4 whitespace-nowrap hidden md:table-cell\">이착륙</th>\n                                        )}\n                                    </tr>\n                                </thead>\n                                <tbody>\n                                    {(() => {\n                                        // 같은 날짜별로 그룹화하여 rowspan 계산\n                                        const groupedFlights: { [date: string]: Flight[] } = {};\n                                        sortedFlights.forEach(flight => {\n                                            if (!groupedFlights[flight.date]) {\n                                                groupedFlights[flight.date] = [];\n                                            }\n                                            groupedFlights[flight.date].push(flight);\n                                        });\n\n                                        const rows: React.ReactElement[] = [];\n                                        Object.keys(groupedFlights).forEach(date => {\n                                            const flightsForDate = groupedFlights[date];\n                                            const showGreenBar = hasRecentChange(flightsForDate);\n                                            flightsForDate.forEach((flight, flightIndex) => {\n                                                const isFirstFlight = flightIndex === 0;\n                                                const rowspan = isFirstFlight ? flightsForDate.length : undefined;\n                                                \n                                                rows.push(\n                                                    <tr \n                                                        key={`${flight.id}-${date}-${flightIndex}`} \n                                                        className={`border-b dark:border-gray-700 cursor-pointer ${\n                                                            isToday(flight.date) \n                                                                ? 'relative' \n                                                                : ''\n                                                        }`}\n                                                        onClick={() => handleFlightClick(flight)}\n                                                    >\n                                                        {isFirstFlight && (\n                                                            <td \n                                                                rowSpan={rowspan}\n                                                                className={`${isKESchedule ? 'px-2 py-2 md:px-3 md:py-3 lg:px-4' : 'px-4 py-3'} font-medium text-gray-900 dark:text-gray-200 whitespace-nowrap relative ${\n                                                                    // 기본 선은 초록색(변경) 선으로 두고\n                                                                    showGreenBar ? 'border-l-4 border-green-500' : 'border-l-4 border-transparent'\n                                                                }`}\n                                                            >\n                                                                {/* 오늘(마젠타 막대)은 같은 세로선 위에 오도록 absolute로 덮어쓰기 */}\n                                                                {isToday(flight.date) && (\n                                                                    <span className={`absolute left-0 top-0 bottom-0 w-1 ${showGreenBar ? 'bg-fuchsia-500' : 'bg-fuchsia-500'}`} aria-hidden />\n                                                                )}\n                                                                {flight.date.substring(5)}\n                                                            </td>\n                                                        )}\n                                            <td className={`${isKESchedule ? 'px-2 py-2 md:px-3 md:py-3 lg:px-4' : 'px-4 py-3'} text-gray-900 dark:text-gray-200 max-w-[100px] break-words`}>\n                                                {flight.flightNumber}\n                                            </td>\n                                            <td className={`${isKESchedule ? 'px-2 py-2 md:px-3 md:py-3 lg:px-4' : 'px-4 py-3'} text-gray-900 dark:text-gray-200 max-w-[120px] break-words ${\n                                                isToday(flight.date) && !isKESchedule && !shouldShowTakeoffLandingButtons\n                                                    ? 'border-r-4 border-fuchsia-500' \n                                                    : ''\n                                            }`}>\n                                                {isActualFlight(flight) \n                                                    ? flight.route?.replace('/', ' → ') \n                                                    : (flight.flightNumber === 'OTHRDUTY' || flight.flightNumber === 'HM SBY' || flight.flightNumber === 'STBY' ? flight.route : \n                                                      flight.flightNumber === 'RESERVE' || flight.flightNumber === 'ALV' || flight.flightNumber === 'ALM' ? '' : '')\n                                                }\n                                            </td>\n                                            {/* KE 스케줄에만 A/C TYPE 컬럼 표시 */}\n                                            {isKESchedule && (\n                                                <td className={`px-2 py-2 md:px-3 md:py-3 lg:px-4 text-gray-900 dark:text-gray-200 text-center ${\n                                                    isToday(flight.date) && !shouldShowTakeoffLandingButtons\n                                                        ? 'border-r-4 border-fuchsia-500' \n                                                        : ''\n                                                }`}>\n                                                    {flight.acType || ''}\n                                                </td>\n                                            )}\n                                            {/* SHOW UP 시간 (데이터베이스에서 가져온 값 사용) */}\n                                            <td className=\"px-4 py-3 md:px-3 md:py-3 lg:px-4 text-gray-900 dark:text-gray-200 whitespace-nowrap hidden md:table-cell\">\n                                                {/* G/S STUDENT, STBY, FIXED SKD 스케줄은 SHOW UP 표시하지 않음 */}\n                                                {flight.flightNumber.toUpperCase().includes('G/S STUDENT') ||\n                                                 flight.flightNumber.toUpperCase().includes('GS STUDENT') ||\n                                                 flight.flightNumber.toUpperCase().includes('STBY') ||\n                                                 flight.flightNumber.toUpperCase().includes('RESERVE') ||\n                                                 flight.flightNumber.toUpperCase().includes('FIXED SKD') ? '' : (\n                                                    flight.showUpDateTimeUtc ? (\n                                                        formatInTimeZone(new Date(flight.showUpDateTimeUtc), 'Asia/Seoul', 'HH:mm')\n                                                    ) : ''\n                                                )}\n                                            </td>\n                                            {/* md(768px) 이상 화면에서만 보이도록 수정 */}\n                                            <td className=\"px-4 py-3 md:px-3 md:py-3 lg:px-4 text-gray-900 dark:text-gray-200 whitespace-nowrap hidden md:table-cell\">\n                                                {/* 특별 스케줄은 STD/STA 표시하지 않음 (단, A STBY/B STBY는 제외) */}\n                                                {flight.flightNumber.toUpperCase().includes('G/S STUDENT') ||\n                                                 flight.flightNumber.toUpperCase().includes('GS STUDENT') ||\n                                                 (flight.flightNumber.toUpperCase().includes('STBY') && \n                                                  !flight.flightNumber.includes('A STBY') && \n                                                  !flight.flightNumber.includes('B STBY')) ||\n                                                 flight.flightNumber.toUpperCase().includes('RESERVE') ||\n                                                 flight.flightNumber.toUpperCase().includes('FIXED SKD') ||\n                                                 flight.flightNumber.toUpperCase().includes('ANNUAL LEAVE') ||\n                                                 flight.flightNumber.toUpperCase().includes('ALV') ||\n                                                 flight.flightNumber.toUpperCase().includes('ALM') ||\n                                                 flight.flightNumber.toUpperCase().includes('MEDICAL CHK') ||\n                                                 flight.flightNumber.toUpperCase().includes('MEDICAL') ||\n                                                 flight.flightNumber.toUpperCase().includes('ORAL') ||\n                                                 flight.flightNumber.toUpperCase().includes('안전회의') ||\n                                                 flight.flightNumber.toUpperCase().includes('SAFETY') ? (\n                                                    // A STBY/B STBY는 특별 시간 표시\n                                                    flight.flightNumber === 'A STBY' ? '04:00' :\n                                                    flight.flightNumber === 'B STBY' ? '09:00' : ''\n                                                 ) : (\n                                                    // A STBY/B STBY는 OZ 스케줄이면 하드코딩된 시간, 다른 스케줄은 실제 시간 사용\n                                                    flight.flightNumber === 'A STBY' || flight.flightNumber === 'B STBY' ? (\n                                                        userInfo?.company === 'OZ' ? (\n                                                            flight.flightNumber === 'A STBY' ? '04:00' : '09:00'\n                                                        ) : (\n                                                            flight.departureDateTimeUtc ? (\n                                                                (() => {\n                                                                    const depUtc = new Date(flight.departureDateTimeUtc);\n                                                                    return formatInTimeZone(depUtc, 'Asia/Seoul', 'HH:mm');\n                                                                })()\n                                                            ) : (\n                                                                flight.flightNumber === 'A STBY' ? '04:00' : '09:00'\n                                                            )\n                                                        )\n                                                    ) : (\n                                                        flight.departureDateTimeUtc && flight.route ? (\n                                                            (() => {\n                                                                const depUtc = new Date(flight.departureDateTimeUtc);\n                                                                const departureAirport = flight.route.split('/')[0];\n                                                                const departureTimezone = getAirportTimeZone(departureAirport);\n                                                                return formatInTimeZone(depUtc, departureTimezone, 'HH:mm');\n                                                            })()\n                                                        ) : ''\n                                                    )\n                                                )}\n                                            </td>\n                                            <td className={`px-4 py-3 md:px-3 md:py-3 lg:px-4 text-gray-900 dark:text-gray-200 whitespace-nowrap hidden md:table-cell ${\n                                                isToday(flight.date) && !shouldShowTakeoffLandingButtons\n                                                    ? 'border-r-4 border-fuchsia-500' \n                                                    : ''\n                                            }`}>\n                                                {/* 특별 스케줄은 STD/STA 표시하지 않음 (단, A STBY/B STBY는 제외) */}\n                                                {flight.flightNumber.toUpperCase().includes('G/S STUDENT') ||\n                                                 flight.flightNumber.toUpperCase().includes('GS STUDENT') ||\n                                                 (flight.flightNumber.toUpperCase().includes('STBY') && \n                                                  !flight.flightNumber.includes('A STBY') && \n                                                  !flight.flightNumber.includes('B STBY')) ||\n                                                 flight.flightNumber.toUpperCase().includes('RESERVE') ||\n                                                 flight.flightNumber.toUpperCase().includes('FIXED SKD') ||\n                                                 flight.flightNumber.toUpperCase().includes('ANNUAL LEAVE') ||\n                                                 flight.flightNumber.toUpperCase().includes('ALV') ||\n                                                 flight.flightNumber.toUpperCase().includes('ALM') ||\n                                                 flight.flightNumber.toUpperCase().includes('MEDICAL CHK') ||\n                                                 flight.flightNumber.toUpperCase().includes('MEDICAL') ||\n                                                 flight.flightNumber.toUpperCase().includes('ORAL') ||\n                                                 flight.flightNumber.toUpperCase().includes('안전회의') ||\n                                                 flight.flightNumber.toUpperCase().includes('SAFETY') ? (\n                                                    // A STBY/B STBY는 특별 시간 표시\n                                                    flight.flightNumber === 'A STBY' ? '16:00' :\n                                                    flight.flightNumber === 'B STBY' ? '21:00' : ''\n                                                 ) : (\n                                                    // A STBY/B STBY는 OZ 스케줄이면 하드코딩된 시간, 다른 스케줄은 실제 시간 사용\n                                                    flight.flightNumber === 'A STBY' || flight.flightNumber === 'B STBY' ? (\n                                                        userInfo?.company === 'OZ' ? (\n                                                            flight.flightNumber === 'A STBY' ? '16:00' : '21:00'\n                                                        ) : (\n                                                            flight.arrivalDateTimeUtc ? (\n                                                                (() => {\n                                                                    const arrUtc = new Date(flight.arrivalDateTimeUtc);\n                                                                    return formatInTimeZone(arrUtc, 'Asia/Seoul', 'HH:mm');\n                                                                })()\n                                                            ) : (\n                                                                flight.flightNumber === 'A STBY' ? '16:00' : '21:00'\n                                                            )\n                                                        )\n                                                    ) : (\n                                                        flight.arrivalDateTimeUtc && flight.route ? (\n                                                            (() => {\n                                                                const arrUtc = new Date(flight.arrivalDateTimeUtc);\n                                                                const arrivalAirport = flight.route.split('/')[1];\n                                                                const arrivalTimezone = getAirportTimeZone(arrivalAirport);\n                                                                return formatInTimeZone(arrUtc, arrivalTimezone, 'HH:mm');\n                                                            })()\n                                                        ) : ''\n                                                    )\n                                                )}\n                                            </td>\n                                            {shouldShowTakeoffLandingButtons && (\n                                                <td className={`px-4 py-3 md:px-3 md:py-3 lg:px-4 whitespace-nowrap hidden md:table-cell ${\n                                                    isToday(flight.date) \n                                                        ? 'border-r-4 border-fuchsia-500' \n                                                        : ''\n                                                }`}>\n                                                    {isActualFlight(flight) && flight.route && (\n                                                        <div className=\"flex items-center justify-center gap-2\">\n                                                            <button\n                                                                onClick={(e) => {\n                                                                    e.stopPropagation();\n                                                                    // 로컬 상태 즉시 업데이트\n                                                                    setLocalFlights(prevFlights => \n                                                                        prevFlights.map(f => \n                                                                            f.id === flight.id \n                                                                                ? { ...f, status: { ...f.status, departed: !f.status?.departed } }\n                                                                                : f\n                                                                        )\n                                                                    );\n                                                                    // 부모 컴포넌트 상태도 업데이트\n                                                                    onStatusChange?.(flight.id, { departed: !flight.status?.departed });\n                                                                }}\n                                                                title=\"이륙 완료\"\n                                                                className={`w-5 h-5 rounded-full flex items-center justify-center text-xs font-bold text-white transition-colors cursor-pointer ${\n                                                                    flight.status?.departed \n                                                                        ? 'bg-blue-500 hover:bg-blue-600' \n                                                                        : 'bg-gray-300 dark:bg-gray-600 hover:bg-blue-400 dark:hover:bg-blue-500'\n                                                                }`}\n                                                            >\n                                                                T\n                                                            </button>\n                                                            <button\n                                                                onClick={(e) => {\n                                                                    e.stopPropagation();\n                                                                    // 로컬 상태 즉시 업데이트\n                                                                    setLocalFlights(prevFlights => \n                                                                        prevFlights.map(f => \n                                                                            f.id === flight.id \n                                                                                ? { ...f, status: { ...f.status, landed: !f.status?.landed } }\n                                                                                : f\n                                                                        )\n                                                                    );\n                                                                    // 부모 컴포넌트 상태도 업데이트\n                                                                    onStatusChange?.(flight.id, { landed: !flight.status?.landed });\n                                                                }}\n                                                                title=\"착륙 완료\"\n                                                                className={`w-5 h-5 rounded-full flex items-center justify-center text-xs font-bold text-white transition-colors cursor-pointer ${\n                                                                    flight.status?.landed \n                                                                        ? 'bg-green-500 hover:bg-green-600' \n                                                                        : 'bg-gray-300 dark:bg-gray-600 hover:bg-green-400 dark:hover:bg-green-500'\n                                                                }`}\n                                                            >\n                                                                L\n                                                            </button>\n                                                        </div>\n                                                    )}\n                                                </td>\n                                                        )}\n                                                    </tr>\n                                                );\n                                            });\n                                        });\n                                        \n                                        return rows;\n                                    })()}\n                                </tbody>\n                            </table>\n                        ) : (\n                            <p className=\"text-gray-500 dark:text-gray-400 text-center py-8\">해당 월의 스케줄이 없습니다.</p>\n                        )}\n                    </div>\n                </div>\n            </div>\n        </>\n    );\n};\n\nexport default MonthlyScheduleModal;"],"names":["getAirportTimeZone","airportCode","MonthlyScheduleModal","data","onClose","onFlightClick","onMonthChange","onStatusChange","userInfo","showScrollbar","setShowScrollbar","useState","scrollTimeoutRef","useRef","localFlights","setLocalFlights","useEffect","month","flights","blockTime","sortedFlights","acc","current","flight","a","b","dateA","dateB","stdA","stdB","formatTime","time","formattedStdA","formattedStdB","today","currentDisplayYear","isCurrentMonthSchedule","isPastMonthSchedule","shouldShowTakeoffLandingButtons","deviceTimeZone","todayLocalStr","formatInTimeZone","isToday","flightDate","isKESchedule","handleFlightClick","handlePreviousMonth","newMonth","handleNextMonth","handleScroll","e","changedDatesPayload","raw","changedDatesSet","hasRecentChange","flightsForDate","dateKey","jsx","jsxs","XIcon","groupedFlights","rows","date","showGreenBar","flightIndex","isFirstFlight","rowspan","isActualFlight","depUtc","departureAirport","departureTimezone","arrUtc","arrivalAirport","arrivalTimezone","prevFlights","f"],"mappings":"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"}