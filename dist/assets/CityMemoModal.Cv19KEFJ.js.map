{"version":3,"file":"CityMemoModal.Cv19KEFJ.js","sources":["../../components/modals/CityMemoModal.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { XIcon } from '../icons';\n\ninterface CityMemoModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    cityCode: string;\n    initialMemo: string;\n    onSave: (cityCode: string, memo: string) => Promise<void>;\n}\n\nconst CityMemoModal: React.FC<CityMemoModalProps> = ({ isOpen, onClose, cityCode, initialMemo, onSave }) => {\n    const [memo, setMemo] = useState(initialMemo);\n    const [isComposing, setIsComposing] = useState(false);\n    const draftMemoRef = useRef<string>(initialMemo);\n    const [editLength, setEditLength] = useState<number>(initialMemo?.length || 0);\n\n    // ì½ê¸° í‘œì‹œìš©: ê°€ìš´ë° ì •ë ¬ ë“± ë¶ˆí•„ìš”í•œ ì¸ë¼ì¸ ì •ë ¬ì„ ì œê±°\n    const sanitizeForRead = (html: string): string => {\n        if (!html) return html;\n        let out = html;\n        out = out.replace(/text-align\\s*:\\s*center;?/gi, '');\n        out = out.replace(/text-align\\s*:\\s*right;?/gi, '');\n        out = out.replace(/text-align\\s*:\\s*justify;?/gi, '');\n        out = out.replace(/align\\s*=\\s*\"?center\"?/gi, '');\n        out = out.replace(/align\\s*=\\s*\"?right\"?/gi, '');\n        // ë¹ˆ style ì œê±°\n        out = out.replace(/style\\s*=\\s*\"\\s*\"/gi, '');\n        return out;\n    };\n    const [isSaving, setIsSaving] = useState(false);\n    const [isEditing, setIsEditing] = useState(false);\n    const [showTextColorPalette, setShowTextColorPalette] = useState(false);\n    const [showBackgroundColorPalette, setShowBackgroundColorPalette] = useState(false);\n    const [showSymbolPalette, setShowSymbolPalette] = useState(false);\n    const modalRef = useRef<HTMLDivElement>(null);\n    const textareaRef = useRef<HTMLTextAreaElement>(null);\n    const MAX_LENGTH = 10000;\n\n    useEffect(() => {\n        if (isOpen) {\n            setMemo(initialMemo);\n            setIsEditing(false); // ëª¨ë‹¬ì´ ì—´ë¦´ ë•Œ í¸ì§‘ ëª¨ë“œ í•´ì œ\n            // ëª¨ë‹¬ì´ ì—´ë¦´ ë•Œ ë°°ê²½ ìŠ¤í¬ë¡¤ ë°©ì§€\n            document.body.style.overflow = 'hidden';\n            // ëª¨ë‹¬ì´ ì—´ë¦´ ë•Œë§ˆë‹¤ í…ìŠ¤íŠ¸ ì˜ì—­ ë†’ì´ ì¡°ì •\n            setTimeout(() => {\n                adjustTextareaHeight();\n            }, 0);\n        } else {\n            // ëª¨ë‹¬ì´ ë‹«í ë•Œ ë°°ê²½ ìŠ¤í¬ë¡¤ ë³µì›\n            document.body.style.overflow = 'unset';\n        }\n\n        // ì»´í¬ë„ŒíŠ¸ ì–¸ë§ˆìš´íŠ¸ ì‹œ ìŠ¤í¬ë¡¤ ë³µì›\n        return () => {\n            document.body.style.overflow = 'unset';\n        };\n    }, [isOpen, initialMemo]);\n\n    // í¸ì§‘ ëª¨ë“œê°€ ë³€ê²½ë  ë•Œ í…ìŠ¤íŠ¸ ì˜ì—­ í¬ì»¤ìŠ¤ ë° ì´ˆê¸° ë‚´ìš© ì£¼ì…\n    useEffect(() => {\n        if (isEditing) {\n            const el = textareaRef.current;\n            if (!el) return;\n            // í¸ì§‘ ì§„ì… ì‹œ í˜„ì¬ memoë¥¼ í•œ ë²ˆë§Œ ì£¼ì… (ì´í›„ íƒ€ì´í•‘ ì¤‘ì—ëŠ” ì¬ì£¼ì… ê¸ˆì§€)\n            if (el.innerHTML !== memo) {\n                el.innerHTML = memo || '';\n            }\n            setTimeout(() => {\n                const node = textareaRef.current;\n                if (!node) return;\n                node.focus();\n                // ì»¤ì„œë¥¼ í…ìŠ¤íŠ¸ ëìœ¼ë¡œ ì´ë™\n                const range = document.createRange();\n                const sel = window.getSelection();\n                range.selectNodeContents(node as Node);\n                range.collapse(false);\n                sel?.removeAllRanges();\n                sel?.addRange(range);\n            }, 100);\n        }\n    }, [isEditing, memo]);\n\n    const adjustTextareaHeight = () => {\n        if (textareaRef.current) {\n            const textarea = textareaRef.current;\n            const minHeight = 300; // ìµœì†Œ ë†’ì´\n            \n            // contentEditable divì˜ ê²½ìš° scrollHeightë¥¼ ì‚¬ìš©í•˜ì—¬ ë‚´ìš©ì— ë§ê²Œ ë†’ì´ ì¡°ì •\n            const scrollHeight = textarea.scrollHeight;\n            \n            // ìµœì†Œ ë†’ì´ë¥¼ ë³´ì¥í•˜ë©´ì„œ ë‚´ìš©ì— ë§ê²Œ ë†’ì´ ì¡°ì •\n            const newHeight = Math.max(minHeight, scrollHeight);\n            textarea.style.height = newHeight + 'px';\n            \n            // í¸ì§‘ ì˜ì—­ ìì²´ ìŠ¤í¬ë¡¤ í—ˆìš©\n            textarea.style.overflowY = 'auto';\n        }\n    };\n\n    // í…ìŠ¤íŠ¸ ë³€ê²½ í•¸ë“¤ëŸ¬\n    const handleTextChange = (e: React.FormEvent<HTMLDivElement>) => {\n        if (isComposing) return; // í•œê¸€ ì¡°í•© ì¤‘ì—ëŠ” ìƒíƒœë¥¼ ê°±ì‹ í•˜ì§€ ì•ŠìŒ (ì»¤ì„œ/ì¡°í•© ë³´í˜¸)\n        const target = e.target as HTMLDivElement;\n        // í¸ì§‘ ì¤‘ì—ëŠ” ìƒíƒœë¥¼ ë°”ê¾¸ì§€ ì•Šê³  refë§Œ ì—…ë°ì´íŠ¸ (ì»¤ì„œ ì•ˆì •ì„±)\n        draftMemoRef.current = target.innerHTML;\n        setEditLength(draftMemoRef.current.length);\n        // í…ìŠ¤íŠ¸ ë³€ê²½ í›„ ë†’ì´ ì¡°ì •\n        setTimeout(() => {\n            adjustTextareaHeight();\n        }, 0);\n    };\n\n    const handleCompositionStart = () => {\n        setIsComposing(true);\n    };\n\n    const handleCompositionEnd = () => {\n        setIsComposing(false);\n        if (textareaRef.current) {\n            draftMemoRef.current = textareaRef.current.innerHTML;\n            setEditLength(draftMemoRef.current.length);\n        }\n        setTimeout(() => {\n            adjustTextareaHeight();\n        }, 0);\n    };\n\n    // ë¶™ì—¬ë„£ê¸° ì •ê·œí™”/ì²˜ë¦¬\n    const normalizePastedText = (text: string): string => {\n        const lines = text.replace(/\\r/g, '').split('\\n');\n        const out: string[] = [];\n        for (let i = 0; i < lines.length; i++) {\n            const cur = lines[i];\n            const next = i + 1 < lines.length ? lines[i + 1] : '';\n            const isBlankNext = next.trim().length === 0;\n            const isBulletNext = /^\\s*(?:â€¢|-|\\d+\\.|\\d+\\))/u.test(next);\n            if (i < lines.length - 1) {\n                if (cur.trim().length === 0) {\n                    out.push('');\n                } else if (isBlankNext || isBulletNext) {\n                    out.push(cur);\n                    out.push('');\n                    if (isBlankNext) i++;\n                } else {\n                    out.push(cur + ' ');\n                }\n            } else {\n                out.push(cur);\n            }\n        }\n        return out\n            .join('\\n')\n            .replace(/ +/g, ' ')\n            .replace(/\\n{2,}/g, '\\n'); // ì—°ì† ê°œí–‰ì€ 1ê°œë¡œ ì¶•ì•½\n    };\n\n    const escapeHtml = (s: string): string => (\n        s.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;')\n    );\n\n    // HTML ì„œì‹ í—ˆìš© ë¶™ì—¬ë„£ê¸°: ì•ˆì „í•˜ê²Œ í—ˆìš©ëœ íƒœê·¸/ìŠ¤íƒ€ì¼ë§Œ ìœ ì§€\n    const sanitizeHtml = (html: string): string => {\n        const container = document.createElement('div');\n        container.innerHTML = html;\n        const ALLOWED_TAGS = new Set(['b', 'strong', 'i', 'em', 'u', 'span', 'br', 'ul', 'ol', 'li', 'p', 'div']);\n        const ALLOWED_CSS = new Set(['color', 'background-color', 'font-weight', 'font-style', 'text-decoration']);\n\n        const sanitizeStyle = (el: HTMLElement) => {\n            if (!el.hasAttribute('style')) return;\n            const style = el.getAttribute('style') || '';\n            const kept: string[] = [];\n            style.split(';').forEach(rule => {\n                const [propRaw, valRaw] = rule.split(':');\n                if (!propRaw || !valRaw) return;\n                const prop = propRaw.trim().toLowerCase();\n                const val = valRaw.trim();\n                if (ALLOWED_CSS.has(prop)) kept.push(`${prop}: ${val}`);\n            });\n            if (kept.length > 0) el.setAttribute('style', kept.join('; '));\n            else el.removeAttribute('style');\n        };\n\n        const walk = (node: Node, parent: Node | null) => {\n            Array.from(node.childNodes).forEach(child => {\n                if (child.nodeType === Node.ELEMENT_NODE) {\n                    const el = child as HTMLElement;\n                    const tag = el.tagName.toLowerCase();\n                    if (!ALLOWED_TAGS.has(tag)) {\n                        // unwrap disallowed element\n                        while (el.firstChild) node.insertBefore(el.firstChild, el);\n                        node.removeChild(el);\n                        return;\n                    }\n                    // styleì€ spanì—ì„œë§Œ í—ˆìš©\n                    if (tag === 'span') sanitizeStyle(el); else el.removeAttribute('style');\n                    // ë‹¤ë¥¸ ì†ì„± ì œê±°\n                    Array.from(el.attributes).forEach(attr => {\n                        if (attr.name.toLowerCase() !== 'style') el.removeAttribute(attr.name);\n                    });\n                    walk(el, node);\n                } else if (child.nodeType === Node.TEXT_NODE) {\n                    // ê·¸ëŒ€ë¡œ ìœ ì§€\n                } else {\n                    node.removeChild(child);\n                }\n            });\n        };\n        walk(container, null);\n        // li ë‚´ë¶€ ì •ë¦¬: <br>, &nbsp; ì œê±° ë° ê³µë°± ì¶•ì•½\n        container.querySelectorAll('li').forEach(li => {\n            let html = li.innerHTML;\n            html = html.replace(/<br\\s*\\/?>(\\s|&nbsp;)*?/gi, ' ');\n            html = html.replace(/&nbsp;/gi, ' ');\n            html = html.replace(/\\s{2,}/g, ' ');\n            li.innerHTML = html.trim();\n        });\n        return container.innerHTML;\n    };\n\n    const handlePaste = (e: React.ClipboardEvent<HTMLDivElement>) => {\n        if (!textareaRef.current) return;\n        e.preventDefault();\n        const htmlData = e.clipboardData.getData('text/html');\n        if (htmlData) {\n            const cleaned = sanitizeHtml(htmlData);\n            document.execCommand('insertHTML', false, cleaned);\n        } else {\n            const plain = e.clipboardData.getData('text/plain');\n            const normalized = normalizePastedText(plain);\n            const html = escapeHtml(normalized).replace(/\\n/g, '<br>');\n            document.execCommand('insertHTML', false, html);\n        }\n        draftMemoRef.current = textareaRef.current.innerHTML;\n        setEditLength(draftMemoRef.current.length);\n        setTimeout(() => adjustTextareaHeight(), 0);\n    };\n\n    // innerHTML ì„¤ì •ì„ ìœ„í•œ useEffect (ì½ê¸° ëª¨ë“œì—ì„œë§Œ ë°˜ì˜)\n    useEffect(() => {\n        if (!isEditing && textareaRef.current && memo !== textareaRef.current.innerHTML) {\n            textareaRef.current.innerHTML = memo || `<span class=\"text-gray-500 dark:text-gray-400\">${cityCode} ë„ì‹œì— ëŒ€í•œ ë©”ëª¨ë¥¼ ì…ë ¥í•˜ì„¸ìš”...</span>`;\n            setTimeout(() => {\n                adjustTextareaHeight();\n            }, 0);\n        }\n    }, [memo, isEditing, cityCode]);\n\n    // í‚¤ ì…ë ¥ í•¸ë“¤ëŸ¬ (ì—”í„° í‚¤ ì²˜ë¦¬)\n    const handleKeyDown = (e: React.KeyboardEvent<HTMLDivElement>) => {\n        if (e.key === 'Enter') {\n            // Shift+EnterëŠ” ì¤„ë°”ê¿ˆ, Enter ë‹¨ë…ë„ ì¤„ë°”ê¿ˆ í—ˆìš©\n            document.execCommand('insertLineBreak');\n            e.preventDefault();\n            return;\n        }\n    };\n\n    // ëª©ë¡ ê¸°ëŠ¥ (contentEditableìš©)\n    const insertList = (ordered: boolean = false) => {\n        if (textareaRef.current) {\n            const selection = window.getSelection();\n            if (selection && selection.rangeCount > 0) {\n                const range = selection.getRangeAt(0);\n            \n            // ë“¤ì—¬ì“°ê¸°ì™€ ì /ë²ˆí˜¸ ì¶”ê°€\n            const indent = '    '; // 4ì¹¸ ë“¤ì—¬ì“°ê¸° (ê³µë°±)\n            const bullet = ordered ? '1. ' : 'â€¢ ';\n            const listText = indent + bullet;\n            \n            // í˜„ì¬ ìœ„ì¹˜ì— ëª©ë¡ í…ìŠ¤íŠ¸ ì‚½ì…\n                const textNode = document.createTextNode(listText);\n                range.deleteContents();\n                range.insertNode(textNode);\n            \n            // ì»¤ì„œë¥¼ ëª©ë¡ í…ìŠ¤íŠ¸ ë’¤ë¡œ ì´ë™\n                range.setStartAfter(textNode);\n                range.setEndAfter(textNode);\n                selection.removeAllRanges();\n                selection.addRange(range);\n                \n                // ë©”ëª¨ ìƒíƒœ ì—…ë°ì´íŠ¸\n                setMemo(textareaRef.current.innerHTML);\n            }\n        }\n    };\n\n    // í°íŠ¸ í¬ê¸° ë³€ê²½\n    const changeFontSize = (size: string) => {\n        if (!textareaRef.current) return;\n        const selection = window.getSelection();\n        if (!(selection && selection.rangeCount > 0)) return;\n        const range = selection.getRangeAt(0);\n        if (!range) return;\n        const selectedText = range.toString();\n        if (!selectedText) return;\n        const span = document.createElement('span');\n        span.style.fontSize = `${size}px`;\n        span.textContent = selectedText;\n        range.deleteContents();\n        range.insertNode(span);\n        // ì»¤ì„œë¥¼ ë°©ê¸ˆ ì‚½ì…í•œ span ë’¤ë¡œ ì´ë™\n        range.setStartAfter(span);\n        range.setEndAfter(span);\n        selection.removeAllRanges();\n        selection.addRange(range);\n        // ìƒíƒœëŠ” refë¡œë§Œ ì—…ë°ì´íŠ¸ (ì»¤ì„œ ì•ˆì •ì„±)\n        draftMemoRef.current = textareaRef.current.innerHTML;\n        setEditLength(draftMemoRef.current.length);\n    };\n\n    // í…ìŠ¤íŠ¸ ìƒ‰ìƒ ë³€ê²½\n    const changeTextColor = (color: string) => {\n        if (textareaRef.current) {\n            const selection = window.getSelection();\n            if (selection && selection.rangeCount > 0) {\n                const range = selection.getRangeAt(0);\n                if (!range) return;\n                const selectedText = range.toString();\n                if (selectedText) {\n                    if (color === '#000000') {\n                        // ê¸°ë³¸ìƒ‰(ê²€ì€ìƒ‰)ì„ ì„ íƒí•˜ë©´ ìƒ‰ìƒ ì œê±°\n                        let container = range.commonAncestorContainer;\n                        if (container.nodeType === Node.TEXT_NODE) {\n                            container = container.parentNode!;\n                        }\n                        \n                        // span íƒœê·¸ë¥¼ ì°¾ì•„ì„œ ìƒ‰ìƒ ì œê±°\n                        let spanElement = null;\n                        let currentElement = container;\n                        \n                        // ë¶€ëª¨ ìš”ì†Œë“¤ì„ ìˆœíšŒí•˜ë©´ì„œ color ìŠ¤íƒ€ì¼ì´ ìˆëŠ” span ì°¾ê¸°\n                        while (currentElement && currentElement !== textareaRef.current) {\n                            if (currentElement.nodeType === Node.ELEMENT_NODE) {\n                                const element = currentElement as HTMLElement;\n                                if (element.tagName === 'SPAN' && element.style.color) {\n                                    spanElement = element;\n                                    break;\n                                }\n                            }\n                            currentElement = currentElement.parentNode;\n                        }\n                        \n                        if (spanElement) {\n                            const parent = spanElement.parentNode;\n                            if (parent) {\n                                parent.insertBefore(document.createTextNode(spanElement.textContent || ''), spanElement);\n                                parent.removeChild(spanElement);\n                            }\n                        }\n                    } else {\n                        const span = document.createElement('span');\n                        span.style.color = color;\n                        span.textContent = selectedText;\n                        range.deleteContents();\n                        range.insertNode(span);\n                        range.setStartAfter(span);\n                        range.setEndAfter(span);\n                        selection.removeAllRanges();\n                        selection.addRange(range);\n                    }\n                    draftMemoRef.current = textareaRef.current.innerHTML;\n                    setEditLength(draftMemoRef.current.length);\n                }\n            }\n        }\n    };\n\n    // ë°°ê²½ ìƒ‰ìƒ ë³€ê²½\n    const changeBackgroundColor = (color: string) => {\n        if (!textareaRef.current) return;\n        const selection = window.getSelection();\n        if (!(selection && selection.rangeCount > 0)) return;\n        const range = selection.getRangeAt(0);\n        if (!range) return;\n        const selectedText = range.toString();\n        if (!selectedText) return;\n        const bgColor = color === 'transparent' ? 'transparent' : color;\n        const span = document.createElement('span');\n        span.style.backgroundColor = bgColor;\n        span.textContent = selectedText;\n        range.deleteContents();\n        range.insertNode(span);\n        range.setStartAfter(span);\n        range.setEndAfter(span);\n        selection.removeAllRanges();\n        selection.addRange(range);\n        draftMemoRef.current = textareaRef.current.innerHTML;\n        setEditLength(draftMemoRef.current.length);\n    };\n\n    // ë³¼ë“œ í† ê¸€\n    const applyBold = () => {\n        if (textareaRef.current) {\n            const selection = window.getSelection();\n            if (selection && selection.rangeCount > 0) {\n                const range = selection.getRangeAt(0);\n                if (!range) return; // rangeê°€ undefinedì¸ ê²½ìš° ì•ˆì „í•˜ê²Œ ë¦¬í„´\n                \n                const selectedText = range.toString();\n                \n                if (selectedText) {\n                    // ì„ íƒëœ í…ìŠ¤íŠ¸ê°€ ì´ë¯¸ strong íƒœê·¸ ì•ˆì— ìˆëŠ”ì§€ í™•ì¸\n                    let container = range.commonAncestorContainer;\n                    if (container.nodeType === Node.TEXT_NODE) {\n                        container = container.parentNode!;\n                    }\n                    \n                    // strong íƒœê·¸ë¥¼ ì°¾ì•„ì„œ í† ê¸€\n                    let strongElement = null;\n                    let currentElement = container;\n                    \n                    // ë¶€ëª¨ ìš”ì†Œë“¤ì„ ìˆœíšŒí•˜ë©´ì„œ strong íƒœê·¸ ì°¾ê¸°\n                    while (currentElement && currentElement !== textareaRef.current) {\n                        if (currentElement.nodeType === Node.ELEMENT_NODE) {\n                            const element = currentElement as HTMLElement;\n                            if (element.tagName === 'STRONG') {\n                                strongElement = element;\n                                break;\n                            }\n                        }\n                        currentElement = currentElement.parentNode;\n                    }\n                    \n                    if (strongElement) {\n                        // ì´ë¯¸ ë³¼ë“œì´ë©´ í•´ì œ\n                        const parent = strongElement.parentNode;\n                        if (parent) {\n                            parent.insertBefore(document.createTextNode(strongElement.textContent || ''), strongElement);\n                            parent.removeChild(strongElement);\n                        }\n                    } else {\n                        // ë³¼ë“œê°€ ì•„ë‹ˆë©´ ì ìš©\n                        const strong = document.createElement('strong');\n                        strong.textContent = selectedText;\n                        range.deleteContents();\n                        range.insertNode(strong);\n                    }\n                    setMemo(textareaRef.current.innerHTML);\n                }\n            }\n        }\n    };\n\n    // ì´íƒ¤ë¦­ í† ê¸€\n    const applyItalic = () => {\n        if (textareaRef.current) {\n            const selection = window.getSelection();\n            if (selection && selection.rangeCount > 0) {\n                const range = selection.getRangeAt(0);\n                if (!range) return; // rangeê°€ undefinedì¸ ê²½ìš° ì•ˆì „í•˜ê²Œ ë¦¬í„´\n                \n                const selectedText = range.toString();\n                \n                if (selectedText) {\n                    // ì„ íƒëœ í…ìŠ¤íŠ¸ê°€ ì´ë¯¸ em íƒœê·¸ ì•ˆì— ìˆëŠ”ì§€ í™•ì¸\n                    let container = range.commonAncestorContainer;\n                    if (container.nodeType === Node.TEXT_NODE) {\n                        container = container.parentNode!;\n                    }\n                    \n                    // em íƒœê·¸ë¥¼ ì°¾ì•„ì„œ í† ê¸€\n                    let emElement = null;\n                    let currentElement = container;\n                    \n                    // ë¶€ëª¨ ìš”ì†Œë“¤ì„ ìˆœíšŒí•˜ë©´ì„œ em íƒœê·¸ ì°¾ê¸°\n                    while (currentElement && currentElement !== textareaRef.current) {\n                        if (currentElement.nodeType === Node.ELEMENT_NODE) {\n                            const element = currentElement as HTMLElement;\n                            if (element.tagName === 'EM') {\n                                emElement = element;\n                                break;\n                            }\n                        }\n                        currentElement = currentElement.parentNode;\n                    }\n                    \n                    if (emElement) {\n                        // ì´ë¯¸ ì´íƒ¤ë¦­ì´ë©´ í•´ì œ\n                        const parent = emElement.parentNode;\n                        if (parent) {\n                            parent.insertBefore(document.createTextNode(emElement.textContent || ''), emElement);\n                            parent.removeChild(emElement);\n                        }\n                    } else {\n                        // ì´íƒ¤ë¦­ì´ ì•„ë‹ˆë©´ ì ìš©\n                        const em = document.createElement('em');\n                        em.textContent = selectedText;\n                        range.deleteContents();\n                        range.insertNode(em);\n                    }\n                    setMemo(textareaRef.current.innerHTML);\n                }\n            }\n        }\n    };\n\n    // ë°‘ì¤„ í† ê¸€\n    const applyUnderline = () => {\n        if (textareaRef.current) {\n            const selection = window.getSelection();\n            if (selection && selection.rangeCount > 0) {\n                const range = selection.getRangeAt(0);\n                if (!range) return; // rangeê°€ undefinedì¸ ê²½ìš° ì•ˆì „í•˜ê²Œ ë¦¬í„´\n                \n                const selectedText = range.toString();\n                \n                if (selectedText) {\n                    // ì„ íƒëœ í…ìŠ¤íŠ¸ê°€ ì´ë¯¸ u íƒœê·¸ ì•ˆì— ìˆëŠ”ì§€ í™•ì¸\n                    let container = range.commonAncestorContainer;\n                    if (container.nodeType === Node.TEXT_NODE) {\n                        container = container.parentNode!;\n                    }\n                    \n                    // u íƒœê·¸ë¥¼ ì°¾ì•„ì„œ í† ê¸€\n                    let uElement = null;\n                    let currentElement = container;\n                    \n                    // ë¶€ëª¨ ìš”ì†Œë“¤ì„ ìˆœíšŒí•˜ë©´ì„œ u íƒœê·¸ ì°¾ê¸°\n                    while (currentElement && currentElement !== textareaRef.current) {\n                        if (currentElement.nodeType === Node.ELEMENT_NODE) {\n                            const element = currentElement as HTMLElement;\n                            if (element.tagName === 'U') {\n                                uElement = element;\n                                break;\n                            }\n                        }\n                        currentElement = currentElement.parentNode;\n                    }\n                    \n                    if (uElement) {\n                        // ì´ë¯¸ ë°‘ì¤„ì´ë©´ í•´ì œ\n                        const parent = uElement.parentNode;\n                        if (parent) {\n                            parent.insertBefore(document.createTextNode(uElement.textContent || ''), uElement);\n                            parent.removeChild(uElement);\n                        }\n                    } else {\n                        // ë°‘ì¤„ì´ ì•„ë‹ˆë©´ ì ìš©\n                        const u = document.createElement('u');\n                        u.textContent = selectedText;\n                        range.deleteContents();\n                        range.insertNode(u);\n                    }\n                    setMemo(textareaRef.current.innerHTML);\n                }\n            }\n        }\n    };\n\n    // íŠ¹ìˆ˜ë¬¸ì ì‚½ì…\n    const insertSymbol = (symbol: string) => {\n        if (textareaRef.current) {\n            const selection = window.getSelection();\n            if (selection && selection.rangeCount > 0) {\n                const range = selection.getRangeAt(0);\n                range.deleteContents();\n                range.insertNode(document.createTextNode(symbol));\n                range.collapse(false);\n                setMemo(textareaRef.current.innerHTML);\n            }\n        }\n    };\n\n    const handleSave = async () => {\n        setIsSaving(true);\n        try {\n            // í¸ì§‘ ì¤‘ ìµœì‹  ë‚´ìš© ë³´ì¥\n            const latest = textareaRef.current?.innerHTML ?? draftMemoRef.current ?? memo;\n            if (latest !== memo) {\n                setMemo(latest);\n            }\n            await onSave(cityCode, latest);\n            setIsEditing(false);\n            // ì €ì¥ í›„ ëª¨ë‹¬ì„ ë‹«ì§€ ì•ŠìŒ\n        } catch (error) {\n            console.error('ë©”ëª¨ ì €ì¥ ì‹¤íŒ¨:', error);\n            alert('ë©”ëª¨ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');\n        } finally {\n            setIsSaving(false);\n        }\n    };\n\n    const handleCancel = () => {\n        setMemo(initialMemo);\n        setIsEditing(false);\n        onClose();\n    };\n\n    const handleEdit = () => {\n        setIsEditing(true);\n        // í¸ì§‘ ëª¨ë“œ ì§„ì… ì‹œ í…ìŠ¤íŠ¸ ì˜ì—­ì— í¬ì»¤ìŠ¤ ì„¤ì •\n        setTimeout(() => {\n            if (textareaRef.current) {\n                textareaRef.current.focus();\n                // ì»¤ì„œë¥¼ ëìœ¼ë¡œ ì´ë™ (contentEditableìš©)\n                const range = document.createRange();\n                const sel = window.getSelection();\n                range.selectNodeContents(textareaRef.current);\n                range.collapse(false);\n                sel?.removeAllRanges();\n                sel?.addRange(range);\n            }\n        }, 100);\n    };\n\n    const handleCancelEdit = () => {\n        setMemo(initialMemo);\n        setIsEditing(false);\n    };\n\n    const handleDelete = async () => {\n        if (window.confirm('ë©”ëª¨ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {\n            setIsSaving(true);\n            try {\n                await onSave(cityCode, ''); // Save empty string to delete memo\n                onClose();\n            } catch (error) {\n                console.error('ë©”ëª¨ ì‚­ì œ ì‹¤íŒ¨:', error);\n                alert('ë©”ëª¨ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');\n            } finally {\n                setIsSaving(false);\n            }\n        }\n    };\n\n    // íŒ”ë ˆíŠ¸ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°\n    useEffect(() => {\n        const handleClickOutside = (event: MouseEvent) => {\n            if ((showTextColorPalette || showBackgroundColorPalette || showSymbolPalette) && \n                !(event.target as Element).closest('.color-palette-container') &&\n                !(event.target as Element).closest('.symbol-palette-container')) {\n                setShowTextColorPalette(false);\n                setShowBackgroundColorPalette(false);\n                setShowSymbolPalette(false);\n            }\n        };\n\n        if (showTextColorPalette || showBackgroundColorPalette || showSymbolPalette) {\n            document.addEventListener('mousedown', handleClickOutside);\n        }\n\n        return () => {\n            if (showTextColorPalette || showBackgroundColorPalette || showSymbolPalette) {\n                document.removeEventListener('mousedown', handleClickOutside);\n            }\n        };\n    }, [showTextColorPalette, showBackgroundColorPalette, showSymbolPalette]);\n\n    if (!isOpen) {\n        return null;\n    }\n\n    const handleTouchMove = (e: React.TouchEvent) => {\n        // ëª¨ë‹¬ ë‚´ë¶€ì˜ ìŠ¤í¬ë¡¤ ê°€ëŠ¥í•œ ì˜ì—­ì—ì„œë§Œ ìŠ¤í¬ë¡¤ í—ˆìš©\n        const target = e.target as HTMLElement;\n        const isScrollableArea = target.closest('[contenteditable=\"true\"]') || \n                                 target.closest('.custom-scrollbar') ||\n                                 target.closest('[style*=\"overflow\"]') ||\n                                 target.closest('.memo-content-area');\n        \n        // ìŠ¤í¬ë¡¤ ê°€ëŠ¥í•œ ì˜ì—­ì´ ì•„ë‹ˆë©´ ê¸°ë³¸ ë™ì‘ ë°©ì§€\n        if (!isScrollableArea) {\n            e.preventDefault();\n        }\n    };\n\n    return (\n        <div \n            className=\"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex justify-center items-center z-[110] p-4 pt-safe\" \n            onClick={onClose}\n            onTouchMove={handleTouchMove}\n        >\n            <div \n                ref={modalRef}\n                className=\"bg-white dark:bg-gray-800 rounded-2xl shadow-xl w-full max-w-6xl p-6 relative animate-fade-in-up flex flex-col my-4 custom-scrollbar\" \n                onClick={(e) => e.stopPropagation()}\n                style={{ \n                    maxHeight: '90vh', \n                    height: 'auto',\n                    minHeight: 'auto'\n                }}\n            >\n                <button \n                    onClick={onClose} \n                    className=\"absolute top-4 right-4 text-gray-400 dark:text-gray-300 hover:text-gray-600 dark:hover:text-gray-100 transition-colors\"\n                >\n                    <XIcon className=\"w-6 h-6\" />\n                </button>\n                \n                <div className=\"flex-shrink-0 mb-2\">\n                    <h2 className=\"text-xl font-bold text-gray-900 dark:text-gray-100 mb-1\">\n                        <span className=\"text-blue-600 dark:text-blue-400\">{cityCode}</span> ë„ì‹œ ë©”ëª¨\n                    </h2>\n                </div>\n                \n                <div className=\"flex-1 min-h-0 flex flex-col\">\n                    {/* íˆ´ë°” */}\n                    {isEditing && (\n                        <div className=\"flex-shrink-0 border border-gray-300 dark:border-gray-600 rounded-t-lg bg-gray-50 dark:bg-gray-700 p-2 flex flex-wrap gap-1\">\n                            {/* í°íŠ¸ í¬ê¸° */}\n                            <select\n                                onChange={(e) => changeFontSize(e.target.value)}\n                                defaultValue=\"14\"\n                                className=\"px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100\"\n                                title=\"í°íŠ¸ í¬ê¸°\"\n                            >\n                                <option value=\"8\">8pt</option>\n                                <option value=\"9\">9pt</option>\n                                <option value=\"10\">10pt</option>\n                                <option value=\"11\">11pt</option>\n                                <option value=\"12\">12pt</option>\n                                <option value=\"14\">14pt</option>\n                                <option value=\"16\">16pt</option>\n                                <option value=\"18\">18pt</option>\n                                <option value=\"20\">20pt</option>\n                                <option value=\"24\">24pt</option>\n                            </select>\n                            \n                            {/* í…ìŠ¤íŠ¸ ìƒ‰ìƒ */}\n                            <div className=\"relative color-palette-container\">\n                                <button\n                                    onMouseDown={(e) => e.preventDefault()}\n                                    onClick={() => setShowTextColorPalette(!showTextColorPalette)}\n                                    className=\"px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-600\"\n                                    title=\"í…ìŠ¤íŠ¸ ìƒ‰ìƒ\"\n                                >\n                                    A\n                                </button>\n                                \n                                {showTextColorPalette && (\n                                    <div className=\"absolute top-full left-0 mt-2 p-3 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg shadow-xl\" style={{ zIndex: 9999, width: '140px' }}>\n                                        <div className=\"grid grid-cols-5 gap-2 justify-items-center\">\n                                            {['#000000', '#FFFFFF', '#FF0000', '#00AA00', '#0066FF', '#FF6600', '#9900FF', '#00AAAA', '#FFAA00', '#AA00AA'].map((color) => (\n                                                <button\n                                                    key={color}\n                                                    onMouseDown={(e) => e.preventDefault()}\n                                                    onClick={() => {\n                                                        changeTextColor(color);\n                                                        setShowTextColorPalette(false);\n                                                    }}\n                                                    className=\"w-6 h-6 border border-gray-300 dark:border-gray-600 rounded cursor-pointer hover:scale-110 active:scale-95 transition-transform\"\n                                                    style={{ backgroundColor: color }}\n                                                    title={`í…ìŠ¤íŠ¸ ìƒ‰ìƒ: ${color}`}\n                                                />\n                                            ))}\n                                        </div>\n                                    </div>\n                                )}\n                            </div>\n                            \n                            {/* ë°°ê²½ ìƒ‰ìƒ */}\n                            <div className=\"relative color-palette-container\">\n                                <button\n                                    onMouseDown={(e) => e.preventDefault()}\n                                    onClick={() => setShowBackgroundColorPalette(!showBackgroundColorPalette)}\n                                    className=\"px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-600\"\n                                    title=\"ë°°ê²½ ìƒ‰ìƒ\"\n                                >\n                                    ğŸ¨\n                                </button>\n                                \n                                {showBackgroundColorPalette && (\n                                    <div className=\"absolute top-full left-0 mt-2 p-3 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg shadow-xl\" style={{ zIndex: 9999, width: '140px' }}>\n                                        <div className=\"grid grid-cols-5 gap-2 justify-items-center\">\n                                            {['transparent', '#FFE6E6', '#E6F3FF', '#E6FFE6', '#FFF0E6', '#F0E6FF', '#E6FFFF', '#FFFFE6', '#FFE6F0', '#E6E6E6'].map((color) => (\n                                                <button\n                                                    key={color}\n                                                    onMouseDown={(e) => e.preventDefault()}\n                                                    onClick={() => {\n                                                        changeBackgroundColor(color);\n                                                        setShowBackgroundColorPalette(false);\n                                                    }}\n                                                    className=\"w-6 h-6 border border-gray-300 dark:border-gray-600 rounded cursor-pointer hover:scale-110 active:scale-95 transition-transform\"\n                                                    style={{ backgroundColor: color }}\n                                                    title={color === 'transparent' ? 'ë°°ê²½ ì—†ìŒ' : `ë°°ê²½ ìƒ‰ìƒ: ${color}`}\n                                                />\n                                            ))}\n                                        </div>\n                                    </div>\n                                )}\n                            </div>\n                            \n                            <div className=\"w-px h-6 bg-gray-300 dark:bg-gray-600 mx-1\"></div>\n                            \n                            {/* ë³¼ë“œ */}\n                            <button\n                                onMouseDown={(e) => e.preventDefault()}\n                                onClick={applyBold}\n                                className=\"px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-600 font-bold\"\n                                title=\"êµµê²Œ\"\n                            >\n                                B\n                            </button>\n                            \n                            {/* ì´íƒ¤ë¦­ */}\n                            <button\n                                onMouseDown={(e) => e.preventDefault()}\n                                onClick={applyItalic}\n                                className=\"px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-600 italic\"\n                                title=\"ê¸°ìš¸ì„\"\n                            >\n                                I\n                            </button>\n                            \n                            {/* ë°‘ì¤„ */}\n                            <button\n                                onMouseDown={(e) => e.preventDefault()}\n                                onClick={applyUnderline}\n                                className=\"px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-600 underline\"\n                                title=\"ë°‘ì¤„\"\n                            >\n                                U\n                            </button>\n                            \n                            <div className=\"w-px h-6 bg-gray-300 dark:bg-gray-600 mx-1\"></div>\n                            \n                            {/* íŠ¹ìˆ˜ë¬¸ì */}\n                            <div className=\"relative symbol-palette-container\">\n                                <button\n                                    onMouseDown={(e) => e.preventDefault()}\n                                    onClick={() => setShowSymbolPalette(!showSymbolPalette)}\n                                    className=\"px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-600\"\n                                    title=\"íŠ¹ìˆ˜ë¬¸ì\"\n                                >\n                                    Î©\n                                </button>\n                                \n                                {showSymbolPalette && (\n                                    <div className=\"absolute top-full left-0 mt-2 p-3 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg shadow-xl\" style={{ zIndex: 9999, width: '140px' }}>\n                                        <div className=\"grid grid-cols-5 gap-2 justify-items-center\">\n                                            {['â†', 'â†’', 'â†‘', 'â†“', 'â†µ', 'â—', 'â– ', 'â–²', 'â–¼', 'â—†'].map((symbol) => (\n                                                <button\n                                                    key={symbol}\n                                                    onMouseDown={(e) => e.preventDefault()}\n                                                    onClick={() => {\n                                                        insertSymbol(symbol);\n                                                        setShowSymbolPalette(false);\n                                                    }}\n                                                    className=\"w-6 h-6 border border-gray-300 dark:border-gray-600 rounded cursor-pointer hover:scale-110 active:scale-95 transition-transform text-gray-900 dark:text-gray-100 font-bold\"\n                                                    style={{ fontSize: '13px' }}\n                                                    title={`íŠ¹ìˆ˜ë¬¸ì: ${symbol}`}\n                                                >\n                                                    {symbol}\n                                                </button>\n                                            ))}\n                                        </div>\n                                    </div>\n                                )}\n                            </div>\n                            \n                            {/* ëª©ë¡ */}\n                            <button\n                                onMouseDown={(e) => e.preventDefault()}\n                                onClick={() => insertList(false)}\n                                className=\"px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-600\"\n                                title=\"ëª©ë¡\"\n                            >\n                                â€¢\n                            </button>\n                        </div>\n                    )}\n                    \n                    {/* í…ìŠ¤íŠ¸ ì˜ì—­ */}\n                    <div className=\"flex-1 min-h-0 flex flex-col\">\n                        {isEditing ? (\n                            <div\n                        ref={textareaRef}\n                                contentEditable={true}\n                                suppressContentEditableWarning={true}\n                                onInput={handleTextChange}\n                                onKeyDown={handleKeyDown}\n                                onPaste={handlePaste}\n                                onTouchStart={(e) => e.stopPropagation()}\n                                onTouchMove={(e) => e.stopPropagation()}\n                                onWheel={(e) => e.stopPropagation()}\n                                onCompositionStart={handleCompositionStart}\n                                onCompositionEnd={handleCompositionEnd}\n                                data-placeholder={`${cityCode} ë„ì‹œì— ëŒ€í•œ ë©”ëª¨ë¥¼ ì…ë ¥í•˜ì„¸ìš”...`}\n                                className=\"memo-content-area w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg resize-none transition-colors custom-scrollbar flex-1 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:focus:ring-blue-400 dark:focus:border-blue-400 rounded-t-none\"\n                                style={{ \n                                    minHeight: '200px',\n                                    maxHeight: 'calc(90vh - 180px)',\n                                    height: 'auto',\n                                    overflowY: 'auto',\n                                    overflowX: 'hidden',\n                                    WebkitOverflowScrolling: 'touch',\n                                    touchAction: 'pan-y',\n                                    whiteSpace: 'pre-wrap',\n                                    wordBreak: 'break-word',\n                                    cursor: 'text',\n                                    userSelect: 'text'\n                                }}\n                            />\n                        ) : (\n                            <div\n                                className=\"memo-content-area w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg custom-scrollbar flex-1 bg-white dark:bg-gray-800 text-black dark:text-white\"\n                                style={{ \n                                    minHeight: '200px',\n                                    maxHeight: 'calc(90vh - 180px)',\n                                    height: 'auto',\n                                    overflowY: 'auto',\n                                    overflowX: 'hidden',\n                                    WebkitOverflowScrolling: 'touch',\n                                    touchAction: 'pan-y',\n                                    whiteSpace: 'pre-wrap',\n                                    wordBreak: 'break-word',\n                                    cursor: 'default',\n                                    userSelect: 'text',\n                                    // ëª©ë¡ í•­ëª©ì˜ ìë™ ì¤„ë°”ê¿ˆ ë“¤ì—¬ì“°ê¸°\n                                    textIndent: '0',\n                                    paddingLeft: '0'\n                                }}\n                                css={`\n                                    /* ëª©ë¡ í•­ëª©ì˜ ìë™ ì¤„ë°”ê¿ˆ ë“¤ì—¬ì“°ê¸° */\n                                    .memo-content-area {\n                                        text-indent: 0;\n                                        padding-left: 0;\n                                        line-height: 1.5;\n                                    }\n                                    \n                                    /* ëª©ë¡ í•­ëª©ì´ ìë™ìœ¼ë¡œ ì¤„ë°”ê¿ˆë  ë•Œ ë“¤ì—¬ì“°ê¸° */\n                                    .memo-content-area {\n                                        /* â€¢ ê¸°í˜¸ ë‹¤ìŒ ìœ„ì¹˜ê¹Œì§€ ë“¤ì—¬ì“°ê¸° */\n                                        text-indent: -2em;\n                                        padding-left: 2em;\n                                        hanging-punctuation: first;\n                                    }\n                                    \n                                    /* ì²« ë²ˆì§¸ ì¤„ì€ ë“¤ì—¬ì“°ê¸° í•˜ì§€ ì•ŠìŒ */\n                                    .memo-content-area::first-line {\n                                        text-indent: 0;\n                                    }\n                                    \n                                    /* ëª©ë¡ í•­ëª©ì—ë§Œ ì ìš© */\n                                    .memo-content-area:has(> *:first-child:is([data-bullet])) {\n                                        text-indent: -2em;\n                                        padding-left: 2em;\n                                    }\n                                `}\n                                dangerouslySetInnerHTML={{ \n                                    __html: memo && memo.length > 0 \n                                        ? memo \n                                        : `<div class=\\\"text-gray-400 dark:text-gray-500 italic\\\">${cityCode} ë„ì‹œì— ëŒ€í•œ ë©”ëª¨ë¥¼ ì…ë ¥í•˜ì„¸ìš”...</div>`\n                                }}\n                            />\n                        )}\n                        \n                        <div className=\"flex-shrink-0 text-right text-xs text-gray-400 dark:text-gray-500 mt-1\">\n                            {(isEditing ? editLength : memo.length)}/{MAX_LENGTH.toLocaleString()}\n                        </div>\n                    </div>\n                </div>\n\n                <div className=\"flex-shrink-0 flex justify-between mt-1 pt-1 border-t border-gray-200 dark:border-gray-600\">\n                    {isEditing ? (\n                        <>\n                            <button\n                                onClick={handleDelete}\n                                className=\"px-3 py-1.5 text-sm bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n                                disabled={isSaving || !memo.trim()}\n                            >\n                                ì‚­ì œ\n                            </button>\n                            <div className=\"flex gap-2\">\n                                <button\n                                    onClick={handleCancelEdit}\n                                    className=\"px-3 py-1.5 text-sm bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors\"\n                                    disabled={isSaving}\n                                >\n                                    ì·¨ì†Œ\n                                </button>\n                                <button\n                                    onClick={handleSave}\n                                    className=\"px-3 py-1.5 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n                                    disabled={isSaving}\n                                >\n                                    {isSaving ? 'ì €ì¥ ì¤‘...' : 'ì €ì¥'}\n                                </button>\n                            </div>\n                        </>\n                    ) : (\n                        <div className=\"flex justify-center w-full\">\n                            <button\n                                onClick={(e) => {\n                                    e.preventDefault();\n                                    e.stopPropagation();\n                                    handleEdit();\n                                }}\n                                className=\"px-4 py-1.5 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors cursor-pointer\"\n                                type=\"button\"\n                            >\n                                í¸ì§‘\n                            </button>\n                        </div>\n                    )}\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default CityMemoModal;"],"names":["CityMemoModal","isOpen","onClose","cityCode","initialMemo","onSave","memo","setMemo","useState","isComposing","setIsComposing","draftMemoRef","useRef","editLength","setEditLength","isSaving","setIsSaving","isEditing","setIsEditing","showTextColorPalette","setShowTextColorPalette","showBackgroundColorPalette","setShowBackgroundColorPalette","showSymbolPalette","setShowSymbolPalette","modalRef","textareaRef","MAX_LENGTH","useEffect","adjustTextareaHeight","el","node","range","sel","textarea","minHeight","scrollHeight","newHeight","handleTextChange","target","handleCompositionStart","handleCompositionEnd","normalizePastedText","text","lines","out","i","cur","next","isBlankNext","isBulletNext","escapeHtml","s","sanitizeHtml","html","container","ALLOWED_TAGS","ALLOWED_CSS","sanitizeStyle","style","kept","rule","propRaw","valRaw","prop","val","walk","parent","child","tag","attr","li","handlePaste","htmlData","cleaned","plain","normalized","handleKeyDown","insertList","ordered","selection","listText","textNode","changeFontSize","size","selectedText","span","changeTextColor","color","spanElement","currentElement","element","changeBackgroundColor","bgColor","applyBold","strongElement","strong","applyItalic","emElement","em","applyUnderline","uElement","u","insertSymbol","symbol","handleSave","latest","handleEdit","handleCancelEdit","handleDelete","handleClickOutside","event","handleTouchMove","jsx","jsxs","XIcon","e","Fragment"],"mappings":"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"}