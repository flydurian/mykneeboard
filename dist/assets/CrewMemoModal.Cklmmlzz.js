import{r as d,j as r,X as te}from"./index.8oJwqbgR.js";import"./react-vendor.CdglivQu.js";import"./firebase-vendor.CQY7ULBN.js";import"./utils-vendor.Dc4w0XSH.js";const se=({isOpen:N,onClose:C,crewName:E,initialMemo:m="",onSave:F})=>{const[c,g]=d.useState(m),[M,D]=d.useState(!1),b=d.useRef(m),[L,A]=d.useState(m?.length||0),[y,k]=d.useState(!1),[x,v]=d.useState(!1),[p,T]=d.useState(!1),[f,j]=d.useState(!1),[h,S]=d.useState(!1),H=d.useRef(null),l=d.useRef(null),R=1e4;d.useEffect(()=>(N?(g(m),v(!1),document.body.style.overflow="hidden",setTimeout(()=>{w()},0)):document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[N,m]),d.useEffect(()=>{if(x){const e=l.current;if(!e)return;e.innerHTML!==c&&(e.innerHTML=c||""),setTimeout(()=>{const t=l.current;if(!t)return;t.focus();const a=document.createRange(),i=window.getSelection();a.selectNodeContents(t),a.collapse(!1),i?.removeAllRanges(),i?.addRange(a)},100)}},[x,c]);const w=()=>{if(l.current){const e=l.current,t=200,a=e.scrollHeight,i=Math.max(t,a);e.style.height=i+"px",e.style.overflowY="auto"}},B=e=>{if(M)return;const t=e.target;b.current=t.innerHTML,A(b.current.length),setTimeout(()=>{w()},0)},P=()=>{D(!0)},I=()=>{D(!1),l.current&&(b.current=l.current.innerHTML,A(b.current.length)),setTimeout(()=>{w()},0)};d.useEffect(()=>{!x&&l.current&&c!==l.current.innerHTML&&(l.current.innerHTML=c||'<span class="text-gray-500 dark:text-gray-400">ë©”ëª¨ë¥¼ ìž…ë ¥í•˜ì„¸ìš”...</span>',setTimeout(()=>{w()},0))},[c,x]);const _=e=>{if(e.key==="Enter"){document.execCommand("insertLineBreak"),e.preventDefault();return}},z=(e=!1)=>{if(l.current){const t=window.getSelection();if(t&&t.rangeCount>0){const a=t.getRangeAt(0),s="    "+(e?"1. ":"â€¢ "),n=document.createTextNode(s);a.deleteContents(),a.insertNode(n),a.setStartAfter(n),a.setEndAfter(n),t.removeAllRanges(),t.addRange(a),g(l.current.innerHTML)}}},O=e=>{if(l.current){const t=window.getSelection();if(t&&t.rangeCount>0){const a=t.getRangeAt(0),i=a.toString();if(i){const o=document.createElement("span");o.style.fontSize=`${e}px`,o.textContent=i,a.deleteContents(),a.insertNode(o),g(l.current.innerHTML)}}}},X=e=>{if(l.current){const t=window.getSelection();if(t&&t.rangeCount>0){const a=t.getRangeAt(0),i=a.toString();if(i){if(e==="#000000"){let o=a.commonAncestorContainer;o.nodeType===Node.TEXT_NODE&&(o=o.parentNode);let s=null,n=o;for(;n&&n!==l.current;){if(n.nodeType===Node.ELEMENT_NODE){const u=n;if(u.tagName==="SPAN"&&u.style.color){s=u;break}}n=n.parentNode}if(s){const u=s.parentNode;u&&(u.insertBefore(document.createTextNode(s.textContent||""),s),u.removeChild(s))}}else{const o=document.createElement("span");o.style.color=e,o.textContent=i,a.deleteContents(),a.insertNode(o)}g(l.current.innerHTML)}}}},W=e=>{if(l.current){const t=window.getSelection();if(t&&t.rangeCount>0){const a=t.getRangeAt(0),i=a.toString();if(i){const o=e==="transparent"?"transparent":e,s=document.createElement("span");s.style.backgroundColor=o,s.textContent=i,a.deleteContents(),a.insertNode(s),g(l.current.innerHTML)}}}},$=()=>{if(l.current){const e=window.getSelection();if(e&&e.rangeCount>0){const t=e.getRangeAt(0),a=t.toString();if(a){let i=t.commonAncestorContainer;i.nodeType===Node.TEXT_NODE&&(i=i.parentNode);let o=null,s=i;for(;s&&s!==l.current;){if(s.nodeType===Node.ELEMENT_NODE){const n=s;if(n.tagName==="STRONG"){o=n;break}}s=s.parentNode}if(o){const n=o.parentNode;n&&(n.insertBefore(document.createTextNode(o.textContent||""),o),n.removeChild(o))}else{const n=document.createElement("strong");n.textContent=a,t.deleteContents(),t.insertNode(n)}g(l.current.innerHTML)}}}},U=()=>{if(l.current){const e=window.getSelection();if(e&&e.rangeCount>0){const t=e.getRangeAt(0),a=t.toString();if(a){let i=t.commonAncestorContainer;i.nodeType===Node.TEXT_NODE&&(i=i.parentNode);let o=null,s=i;for(;s&&s!==l.current;){if(s.nodeType===Node.ELEMENT_NODE){const n=s;if(n.tagName==="EM"){o=n;break}}s=s.parentNode}if(o){const n=o.parentNode;n&&(n.insertBefore(document.createTextNode(o.textContent||""),o),n.removeChild(o))}else{const n=document.createElement("em");n.textContent=a,t.deleteContents(),t.insertNode(n)}g(l.current.innerHTML)}}}},Y=()=>{if(l.current){const e=window.getSelection();if(e&&e.rangeCount>0){const t=e.getRangeAt(0),a=t.toString();if(a){let i=t.commonAncestorContainer;i.nodeType===Node.TEXT_NODE&&(i=i.parentNode);let o=null,s=i;for(;s&&s!==l.current;){if(s.nodeType===Node.ELEMENT_NODE){const n=s;if(n.tagName==="U"){o=n;break}}s=s.parentNode}if(o){const n=o.parentNode;n&&(n.insertBefore(document.createTextNode(o.textContent||""),o),n.removeChild(o))}else{const n=document.createElement("u");n.textContent=a,t.deleteContents(),t.insertNode(n)}g(l.current.innerHTML)}}}},G=e=>{if(l.current){const t=window.getSelection();if(t&&t.rangeCount>0){const a=t.getRangeAt(0);a.deleteContents(),a.insertNode(document.createTextNode(e)),a.collapse(!1),g(l.current.innerHTML)}}},K=async()=>{k(!0);try{const e=l.current?.innerHTML??b.current??c;e!==c&&g(e),await F(E,e),v(!1)}catch{}finally{k(!1)}},V=()=>{v(!0),setTimeout(()=>{if(l.current){l.current.focus();const e=document.createRange(),t=window.getSelection();e.selectNodeContents(l.current),e.collapse(!1),t?.removeAllRanges(),t?.addRange(e)}},100)},q=()=>{g(m),v(!1)},J=async()=>{if(window.confirm("ë©”ëª¨ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")){k(!0);try{await F(E,""),C()}catch{alert("ë©”ëª¨ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}finally{k(!1)}}};if(d.useEffect(()=>{const e=t=>{(p||f||h)&&!t.target.closest(".color-palette-container")&&!t.target.closest(".symbol-palette-container")&&(T(!1),j(!1),S(!1))};return(p||f||h)&&document.addEventListener("mousedown",e),()=>{(p||f||h)&&document.removeEventListener("mousedown",e)}},[p,f,h]),!N)return null;const Q=e=>{const t=e.target;t.closest('[contenteditable="true"]')||t.closest(".custom-scrollbar")||t.closest('[style*="overflow"]')||t.closest(".memo-content-area")||e.preventDefault()};return r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex justify-center items-center z-[80] p-4 pt-safe",onClick:C,onTouchMove:Q,children:r.jsxs("div",{ref:H,className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl w-full max-w-md p-6 relative animate-fade-in-up flex flex-col my-4 custom-scrollbar",onClick:e=>e.stopPropagation(),style:{maxHeight:"90vh",height:"auto",minHeight:"auto"},children:[r.jsx("button",{onClick:C,className:"absolute top-4 right-4 text-gray-400 dark:text-gray-300 hover:text-gray-600 dark:hover:text-gray-100 transition-colors",children:r.jsx(te,{className:"w-6 h-6"})}),r.jsx("div",{className:"flex-shrink-0 mb-2",children:r.jsxs("h2",{className:"text-xl font-bold text-gray-900 dark:text-gray-100 mb-1",children:[r.jsx("span",{className:"text-blue-600 dark:text-blue-400",children:E}),"ë‹˜ ë©”ëª¨"]})}),r.jsxs("div",{className:"flex-1 min-h-0 flex flex-col",children:[x&&r.jsxs("div",{className:"flex-shrink-0 border border-gray-300 dark:border-gray-600 rounded-t-lg bg-gray-50 dark:bg-gray-700 p-2 flex flex-wrap gap-1",children:[r.jsxs("select",{onChange:e=>O(e.target.value),defaultValue:"14",className:"px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100",title:"í°íŠ¸ í¬ê¸°",children:[r.jsx("option",{value:"8",children:"8pt"}),r.jsx("option",{value:"9",children:"9pt"}),r.jsx("option",{value:"10",children:"10pt"}),r.jsx("option",{value:"11",children:"11pt"}),r.jsx("option",{value:"12",children:"12pt"}),r.jsx("option",{value:"14",children:"14pt"}),r.jsx("option",{value:"16",children:"16pt"}),r.jsx("option",{value:"18",children:"18pt"}),r.jsx("option",{value:"20",children:"20pt"}),r.jsx("option",{value:"24",children:"24pt"})]}),r.jsxs("div",{className:"relative color-palette-container",children:[r.jsx("button",{onMouseDown:e=>e.preventDefault(),onClick:()=>T(!p),className:"px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-600",title:"í…ìŠ¤íŠ¸ ìƒ‰ìƒ",children:"A"}),p&&r.jsx("div",{className:"absolute top-full left-0 mt-2 p-3 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg shadow-xl",style:{zIndex:9999,width:"140px"},children:r.jsx("div",{className:"grid grid-cols-5 gap-2 justify-items-center",children:["#000000","#FFFFFF","#FF0000","#00AA00","#0066FF","#FF6600","#9900FF","#00AAAA","#FFAA00","#AA00AA"].map(e=>r.jsx("button",{onMouseDown:t=>t.preventDefault(),onClick:()=>{X(e),T(!1)},className:"w-6 h-6 border border-gray-300 dark:border-gray-600 rounded cursor-pointer hover:scale-110 active:scale-95 transition-transform",style:{backgroundColor:e},title:`í…ìŠ¤íŠ¸ ìƒ‰ìƒ: ${e}`},e))})})]}),r.jsxs("div",{className:"relative color-palette-container",children:[r.jsx("button",{onMouseDown:e=>e.preventDefault(),onClick:()=>j(!f),className:"px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-600",title:"ë°°ê²½ ìƒ‰ìƒ",children:"ðŸŽ¨"}),f&&r.jsx("div",{className:"absolute top-full left-0 mt-2 p-3 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg shadow-xl",style:{zIndex:9999,width:"140px"},children:r.jsx("div",{className:"grid grid-cols-5 gap-2 justify-items-center",children:["transparent","#FFE6E6","#E6F3FF","#E6FFE6","#FFF0E6","#F0E6FF","#E6FFFF","#FFFFE6","#FFE6F0","#E6E6E6"].map(e=>r.jsx("button",{onMouseDown:t=>t.preventDefault(),onClick:()=>{W(e),j(!1)},className:"w-6 h-6 border border-gray-300 dark:border-gray-600 rounded cursor-pointer hover:scale-110 active:scale-95 transition-transform",style:{backgroundColor:e},title:e==="transparent"?"ë°°ê²½ ì—†ìŒ":`ë°°ê²½ ìƒ‰ìƒ: ${e}`},e))})})]}),r.jsx("div",{className:"w-px h-6 bg-gray-300 dark:bg-gray-600 mx-1"}),r.jsx("button",{onMouseDown:e=>e.preventDefault(),onClick:$,className:"px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-600 font-bold",title:"êµµê²Œ",children:"B"}),r.jsx("button",{onMouseDown:e=>e.preventDefault(),onClick:U,className:"px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-600 italic",title:"ê¸°ìš¸ìž„",children:"I"}),r.jsx("button",{onMouseDown:e=>e.preventDefault(),onClick:Y,className:"px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-600 underline",title:"ë°‘ì¤„",children:"U"}),r.jsx("div",{className:"w-px h-6 bg-gray-300 dark:bg-gray-600 mx-1"}),r.jsxs("div",{className:"relative symbol-palette-container",children:[r.jsx("button",{onMouseDown:e=>e.preventDefault(),onClick:()=>S(!h),className:"px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-600",title:"íŠ¹ìˆ˜ë¬¸ìž",children:"Î©"}),h&&r.jsx("div",{className:"absolute top-full left-0 mt-2 p-3 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg shadow-xl",style:{zIndex:9999,width:"140px"},children:r.jsx("div",{className:"grid grid-cols-5 gap-2 justify-items-center",children:["â†","â†’","â†‘","â†“","â†µ","â—","â– ","â–²","â–¼","â—†"].map(e=>r.jsx("button",{onMouseDown:t=>t.preventDefault(),onClick:()=>{G(e),S(!1)},className:"w-6 h-6 border border-gray-300 dark:border-gray-600 rounded cursor-pointer hover:scale-110 active:scale-95 transition-transform text-gray-900 dark:text-gray-100 font-bold",style:{fontSize:"13px"},title:`íŠ¹ìˆ˜ë¬¸ìž: ${e}`,children:e},e))})})]}),r.jsx("button",{onMouseDown:e=>e.preventDefault(),onClick:()=>z(!1),className:"px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-600",title:"ëª©ë¡",children:"â€¢"})]}),r.jsxs("div",{className:"flex-1 min-h-0 flex flex-col",children:[x?r.jsx("div",{ref:l,contentEditable:!0,suppressContentEditableWarning:!0,onInput:B,onKeyDown:_,onPaste:e=>{if(!l.current)return;e.preventDefault();const i=e.clipboardData.getData("text/plain").replace(/\r/g,"").split(`
`).map((o,s,n)=>{const u=s+1<n.length?n[s+1]:"",Z=u.trim().length===0,ee=/^\s*(?:â€¢|-|\d+\.|\d+\))/u.test(u);return s<n.length-1?o.trim().length===0?"":Z||ee?o+`
`:o+" ":o}).join(`
`).replace(/ +/g," ").replace(/\n{2,}/g,`
`).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br>");document.execCommand("insertHTML",!1,i)},onTouchStart:e=>e.stopPropagation(),onTouchMove:e=>e.stopPropagation(),onWheel:e=>e.stopPropagation(),onCompositionStart:P,onCompositionEnd:I,"data-placeholder":"ë©”ëª¨ë¥¼ ìž…ë ¥í•˜ì„¸ìš”...",className:"memo-content-area w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg resize-none transition-colors custom-scrollbar flex-1 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:focus:ring-blue-400 dark:focus:border-blue-400 rounded-t-none",style:{minHeight:"150px",maxHeight:"calc(90vh - 130px)",height:"auto",overflowY:"auto",overflowX:"hidden",WebkitOverflowScrolling:"touch",touchAction:"pan-y",whiteSpace:"pre-wrap",wordBreak:"break-word",cursor:"text",userSelect:"text"}}):r.jsx("div",{className:"memo-content-area w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg custom-scrollbar flex-1 bg-white dark:bg-gray-800 text-black dark:text-white",style:{minHeight:"150px",maxHeight:"calc(90vh - 130px)",height:"auto",overflowY:"auto",overflowX:"hidden",WebkitOverflowScrolling:"touch",touchAction:"pan-y",whiteSpace:"pre-wrap",wordBreak:"break-word",cursor:"default",userSelect:"text",textIndent:"0",paddingLeft:"0"},css:`
                                    /* ëª©ë¡ í•­ëª©ì˜ ìžë™ ì¤„ë°”ê¿ˆ ë“¤ì—¬ì“°ê¸° */
                                    .memo-content-area {
                                        text-indent: 0;
                                        padding-left: 0;
                                        line-height: 1.5;
                                    }
                                    
                                    /* ëª©ë¡ í•­ëª©ì´ ìžë™ìœ¼ë¡œ ì¤„ë°”ê¿ˆë  ë•Œ ë“¤ì—¬ì“°ê¸° */
                                    .memo-content-area {
                                        /* â€¢ ê¸°í˜¸ ë‹¤ìŒ ìœ„ì¹˜ê¹Œì§€ ë“¤ì—¬ì“°ê¸° */
                                        text-indent: -2em;
                                        padding-left: 2em;
                                        hanging-punctuation: first;
                                    }
                                    
                                    /* ì²« ë²ˆì§¸ ì¤„ì€ ë“¤ì—¬ì“°ê¸° í•˜ì§€ ì•ŠìŒ */
                                    .memo-content-area::first-line {
                                        text-indent: 0;
                                    }
                                    
                                    /* ëª©ë¡ í•­ëª©ì—ë§Œ ì ìš© */
                                    .memo-content-area:has(> *:first-child:is([data-bullet])) {
                                        text-indent: -2em;
                                        padding-left: 2em;
                                    }
                                `,dangerouslySetInnerHTML:{__html:c&&c.length>0?c:'<div class="text-gray-400 dark:text-gray-500 italic">ë©”ëª¨ë¥¼ ìž…ë ¥í•˜ì„¸ìš”...</div>'}}),r.jsxs("div",{className:"flex-shrink-0 text-right text-xs text-gray-400 dark:text-gray-500 mt-1",children:[x?L:c.length,"/",R.toLocaleString()]})]})]}),r.jsx("div",{className:"flex-shrink-0 flex justify-between mt-1 pt-1 border-t border-gray-200 dark:border-gray-600",children:x?r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:J,className:"px-3 py-1.5 text-sm bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:y||!c.trim(),children:"ì‚­ì œ"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:q,className:"px-3 py-1.5 text-sm bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",disabled:y,children:"ì·¨ì†Œ"}),r.jsx("button",{onClick:K,className:"px-3 py-1.5 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:y,children:y?"ì €ìž¥ ì¤‘...":"ì €ìž¥"})]})]}):r.jsx("div",{className:"flex justify-center w-full",children:r.jsx("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),V()},className:"px-4 py-1.5 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors cursor-pointer",type:"button",children:"íŽ¸ì§‘"})})})]})})};export{se as default};
//# sourceMappingURL=CrewMemoModal.Cklmmlzz.js.map
