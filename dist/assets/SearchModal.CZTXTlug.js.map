{"version":3,"file":"SearchModal.CZTXTlug.js","sources":["../../components/modals/SearchModal.tsx"],"sourcesContent":["import React, { useState, useMemo } from 'react';\nimport { getCityInfo } from '../../utils/cityData';\n\ninterface SearchModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  flights: any[];\n  onCityClick?: (cityCode: string) => void;\n  onCrewClick?: (crewName: string) => void;\n}\n\ninterface CrewMember {\n  name: string;\n  empl: string;\n  rank: string;\n  flights: number;\n}\n\nconst SearchModal: React.FC<SearchModalProps> = ({ isOpen, onClose, flights, onCityClick, onCrewClick }) => {\n  const [searchType, setSearchType] = useState<'city' | 'crew'>('city');\n  const [searchQuery, setSearchQuery] = useState('');\n  const [searchResults, setSearchResults] = useState<any[]>([]);\n  const [showResults, setShowResults] = useState(false);\n\n  const isDarkMode = document.documentElement.classList.contains('dark');\n\n  // 도시 검색 함수\n  const searchCities = (query: string) => {\n    if (!query.trim()) return [];\n    \n    const searchQuery = query.toLowerCase();\n    const results: any[] = [];\n    \n    // 모든 비행에서 도시 정보 수집\n    const cityMap = new Map<string, { code: string; name: string; flights: any[] }>();\n    \n    flights.forEach(flight => {\n      // route 필드에서 출발지와 도착지 파싱 (예: \"ICN-LAX\" 또는 \"ICN LAX\")\n      let departure, arrival;\n      \n      if (flight.route) {\n        // 다양한 구분자 지원: /, -, 공백\n        const routeParts = flight.route.split(/[/\\- ]/);\n        if (routeParts.length >= 2) {\n          departure = routeParts[0];\n          arrival = routeParts[1];\n        } else if (routeParts.length === 1 && routeParts[0] !== 'RESERVE') {\n          // 단일 도시인 경우 (예: \"ICN\", \"GMP\")\n          departure = routeParts[0];\n          arrival = null;\n        }\n      }\n      \n      // 기존 필드들도 확인\n      departure = departure || flight.departure || flight.origin;\n      arrival = arrival || flight.arrival || flight.destination;\n      \n      [departure, arrival].forEach(cityCode => {\n        if (cityCode && cityCode.trim()) {\n          const cityInfo = getCityInfo(cityCode.trim());\n          if (cityInfo) {\n            const key = cityCode.trim().toUpperCase();\n            if (!cityMap.has(key)) {\n              cityMap.set(key, {\n                code: cityCode.trim().toUpperCase(),\n                name: cityInfo.name,\n                flights: []\n              });\n            }\n            cityMap.get(key)!.flights.push(flight);\n          }\n        }\n      });\n    });\n    \n    // 검색어와 매칭되는 도시 필터링\n    Array.from(cityMap.values()).forEach(city => {\n      if (city.code.toLowerCase().includes(searchQuery) || \n          city.name.toLowerCase().includes(searchQuery)) {\n        results.push(city);\n      }\n    });\n    return results.sort((a, b) => b.flights.length - a.flights.length);\n  };\n\n  // CREW 검색 함수\n  const searchCrew = (query: string) => {\n    if (!query.trim()) return [];\n    \n    const searchQuery = query.toLowerCase();\n    const crewMap = new Map<string, CrewMember>();\n    \n    flights.forEach(flight => {\n      if (flight.crew && Array.isArray(flight.crew)) {\n        flight.crew.forEach((member: any) => {\n          const key = member.name || member.empl || '';\n          if (key) {\n            if (!crewMap.has(key)) {\n              crewMap.set(key, {\n                name: member.name || '',\n                empl: member.empl || '',\n                rank: member.rank || '',\n                flights: 0\n              });\n            }\n            crewMap.get(key)!.flights++;\n          }\n        });\n      }\n    });\n    \n    // 검색어와 매칭되는 CREW 필터링\n    const results: CrewMember[] = [];\n    Array.from(crewMap.values()).forEach(member => {\n      // 이름과 사번 모두에서 검색 (대소문자 구분 없음)\n      const nameMatch = member.name.toLowerCase().includes(searchQuery);\n      const emplMatch = member.empl.toLowerCase().includes(searchQuery);\n      \n      if (nameMatch || emplMatch) {\n        results.push(member);\n      }\n    });\n    \n    return results.sort((a, b) => b.flights - a.flights);\n  };\n\n  const handleSearch = () => {\n    if (searchType === 'city') {\n      setSearchResults(searchCities(searchQuery));\n    } else {\n      setSearchResults(searchCrew(searchQuery));\n    }\n    setShowResults(true);\n  };\n\n  const handleClose = () => {\n    setSearchQuery('');\n    setSearchResults([]);\n    setShowResults(false);\n    onClose();\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center z-40 p-4 pt-safe\">\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-lg w-full max-w-md\">\n        {/* 헤더 */}\n        <div className=\"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-600\">\n          <h3 className=\"text-lg font-semibold text-gray-700 dark:text-gray-200\">검색</h3>\n          <button\n            onClick={handleClose}\n            className=\"p-1 text-gray-400 hover:text-gray-600 dark:text-gray-300 dark:hover:text-gray-100 transition-colors\"\n          >\n            <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n            </svg>\n          </button>\n        </div>\n\n        {/* 검색 타입 선택 */}\n        <div className=\"p-4 border-b border-gray-200 dark:border-gray-600\">\n          <div className=\"flex justify-center\">\n            <div className=\"flex w-full max-w-xs\">\n              <button\n                onClick={() => {\n                  setSearchType('city');\n                  setSearchResults([]);\n                  setShowResults(false);\n                }}\n                className={`flex-1 px-4 py-2 text-sm font-medium transition-colors relative ${\n                  searchType === 'city'\n                    ? 'text-blue-600 dark:text-blue-400'\n                    : 'text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200'\n                }`}\n              >\n                도시 검색\n                {searchType === 'city' && (\n                  <div className=\"absolute bottom-0 left-0 right-0 h-0.5 bg-blue-600 dark:bg-blue-400\"></div>\n                )}\n              </button>\n              <button\n                onClick={() => {\n                  setSearchType('crew');\n                  setSearchResults([]);\n                  setShowResults(false);\n                }}\n                className={`flex-1 px-4 py-2 text-sm font-medium transition-colors relative ${\n                  searchType === 'crew'\n                    ? 'text-blue-600 dark:text-blue-400'\n                    : 'text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200'\n                }`}\n              >\n                CREW 검색\n                {searchType === 'crew' && (\n                  <div className=\"absolute bottom-0 left-0 right-0 h-0.5 bg-blue-600 dark:bg-blue-400\"></div>\n                )}\n              </button>\n            </div>\n          </div>\n        </div>\n\n        {/* 검색 입력 */}\n        <div className=\"p-4 space-y-4\">\n          <div>\n            <input\n              type=\"text\"\n              placeholder={searchType === 'city' ? 'IATA code로 입력해주세요. 예) ICN, LAX..' : '사번 또는 이름 입력'}\n              value={searchQuery}\n              onChange={(e) => {\n                const value = e.target.value;\n                // 한글이 포함된 경우 대문자 변환하지 않음\n                const hasKorean = /[ㄱ-ㅎ|ㅏ-ㅣ|가-힣]/.test(value);\n                setSearchQuery(hasKorean ? value : value.toUpperCase());\n                // 검색어가 변경되면 검색 결과 초기화\n                setSearchResults([]);\n                setShowResults(false);\n              }}\n              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 bg-white dark:bg-gray-700\"\n              onKeyPress={(e) => e.key === 'Enter' && handleSearch()}\n            />\n          </div>\n          <button\n            onClick={handleSearch}\n            className=\"w-full bg-blue-500 dark:bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-600 dark:hover:bg-blue-700 transition-colors font-medium\"\n          >\n            검색\n          </button>\n        </div>\n\n        {/* 검색 결과 */}\n        {showResults && (\n          <div className=\"px-4 pb-4 max-h-96 overflow-y-auto border-t border-gray-200 dark:border-gray-600\">\n            {searchResults.length > 0 ? (\n              <div className=\"space-y-3 pt-4\">\n                {searchResults.map((result, index) => (\n                  <div \n                    key={index} \n                    className={`p-3 rounded-lg border border-gray-200 dark:border-gray-600 ${\n                      searchType === 'city' \n                        ? 'bg-gray-50 dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600 cursor-pointer transition-colors' \n                        : 'bg-gray-50 dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600 cursor-pointer transition-colors'\n                    }`}\n                    onClick={searchType === 'city' && onCityClick ? () => {\n                      onCityClick(result.code);\n                      // 검색 모달은 그대로 유지\n                    } : searchType === 'crew' && onCrewClick ? () => {\n                      onCrewClick(result.name);\n                      // 검색 모달은 그대로 유지\n                    } : undefined}\n                  >\n                    {searchType === 'city' ? (\n                      <div>\n                        <div className=\"font-semibold text-gray-700 dark:text-gray-200\">\n                          {result.code} - {result.name}\n                        </div>\n                        <div className=\"text-sm text-gray-500 dark:text-gray-400\">\n                          {result.flights.length}개 비행\n                        </div>\n                      </div>\n                    ) : (\n                      <div>\n                        <div className=\"font-semibold text-gray-700 dark:text-gray-200\">\n                          {result.name}({result.empl})\n                        </div>\n                        <div className=\"text-sm text-gray-500 dark:text-gray-400\">\n                          {result.rank} • {result.flights}개 비행\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                ))}\n              </div>\n            ) : (\n              <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n                검색 결과가 없습니다.\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default SearchModal;\n"],"names":["SearchModal","isOpen","onClose","flights","onCityClick","onCrewClick","searchType","setSearchType","useState","searchQuery","setSearchQuery","searchResults","setSearchResults","showResults","setShowResults","searchCities","query","results","cityMap","flight","departure","arrival","routeParts","cityCode","cityInfo","getCityInfo","key","city","a","b","searchCrew","crewMap","member","nameMatch","emplMatch","handleSearch","handleClose","jsxs","jsx","e","value","hasKorean","result","index"],"mappings":"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"}