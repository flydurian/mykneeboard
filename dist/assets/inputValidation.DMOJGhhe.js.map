{"version":3,"file":"inputValidation.DMOJGhhe.js","sources":["../../utils/inputValidation.ts"],"sourcesContent":["// 입력 검증 및 XSS 방지 유틸리티 함수들\n\n// HTML 태그 제거 및 XSS 방지\nexport const sanitizeInput = (input: string): string => {\n  if (typeof input !== 'string') return '';\n  \n  return input\n    .replace(/[<>]/g, '') // HTML 태그 제거\n    .replace(/javascript:/gi, '') // JavaScript URL 제거\n    .replace(/on\\w+=/gi, '') // 이벤트 핸들러 제거\n    .trim()\n    .substring(0, 1000); // 최대 길이 제한\n};\n\n// 이메일 검증\nexport const validateEmail = (email: string): boolean => {\n  const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n  return emailRegex.test(email) && email.length <= 254;\n};\n\n// 비밀번호 검증\nexport const validatePassword = (password: string): { isValid: boolean; errors: string[] } => {\n  const errors: string[] = [];\n  \n  if (password.length < 6) {\n    errors.push('비밀번호는 6자 이상이어야 합니다.');\n  }\n  \n  if (password.length > 128) {\n    errors.push('비밀번호는 128자 이하여야 합니다.');\n  }\n  \n  // 특수문자나 공백이 포함된 경우 경고 (선택사항)\n  if (/[<>'\"]/.test(password)) {\n    errors.push('비밀번호에 특수문자 < > \\' \" 는 사용할 수 없습니다.');\n  }\n  \n  return {\n    isValid: errors.length === 0,\n    errors\n  };\n};\n\n// 사용자 이름 검증\nexport const validateDisplayName = (name: string): { isValid: boolean; errors: string[] } => {\n  const errors: string[] = [];\n  const sanitized = sanitizeInput(name);\n  \n  if (sanitized.length < 2) {\n    errors.push('사용자 이름은 2자 이상이어야 합니다.');\n  }\n  \n  if (sanitized.length > 50) {\n    errors.push('사용자 이름은 50자 이하여야 합니다.');\n  }\n  \n  if (sanitized !== name) {\n    errors.push('사용자 이름에 허용되지 않는 문자가 포함되어 있습니다.');\n  }\n  \n  return {\n    isValid: errors.length === 0,\n    errors\n  };\n};\n\n// 날짜 검증 (YYYY-MM-DD 형식)\nexport const validateDate = (dateString: string): boolean => {\n  const dateRegex = /^\\d{4}-\\d{2}-\\d{2}$/;\n  if (!dateRegex.test(dateString)) return false;\n  \n  const date = new Date(dateString);\n  const today = new Date();\n  today.setHours(0, 0, 0, 0);\n  \n  // 과거 날짜는 허용하지 않음\n  return date >= today;\n};\n\n// 항공사 코드 검증\nexport const validateAirlineCode = (code: string): boolean => {\n  const validCodes = ['OZ', 'KE', '7C', 'TW', 'BX', 'LJ', 'ZE', 'RS', '4V', 'SL', 'JX', 'NH', 'JL', 'MM'];\n  return validCodes.includes(code.toUpperCase());\n};\n\n// 항공편 번호 검증\nexport const validateFlightNumber = (flightNumber: string): boolean => {\n  const flightRegex = /^[A-Z0-9]{1,4}[0-9]{1,4}$/;\n  return flightRegex.test(flightNumber.toUpperCase()) && flightNumber.length <= 8;\n};\n\n// 공항 코드 검증 (IATA 3자리)\nexport const validateAirportCode = (code: string): boolean => {\n  const airportRegex = /^[A-Z]{3}$/;\n  return airportRegex.test(code.toUpperCase());\n};\n\n// 숫자 검증\nexport const validateNumber = (value: string, min?: number, max?: number): boolean => {\n  const num = parseFloat(value);\n  if (isNaN(num)) return false;\n  \n  if (min !== undefined && num < min) return false;\n  if (max !== undefined && num > max) return false;\n  \n  return true;\n};\n\n// SQL 인젝션 방지 (문자열 검증)\nexport const validateString = (input: string, maxLength: number = 255): boolean => {\n  if (typeof input !== 'string') return false;\n  \n  // SQL 인젝션 패턴 검사\n  const sqlPatterns = [\n    /(\\b(SELECT|INSERT|UPDATE|DELETE|DROP|CREATE|ALTER|EXEC|UNION|SCRIPT)\\b)/gi,\n    /(--|\\/\\*|\\*\\/|xp_|sp_)/gi,\n    /(\\b(OR|AND)\\s+\\d+\\s*=\\s*\\d+)/gi\n  ];\n  \n  for (const pattern of sqlPatterns) {\n    if (pattern.test(input)) return false;\n  }\n  \n  return input.length <= maxLength;\n};\n"],"names":["sanitizeInput","input","validateEmail","email","validatePassword","password","errors","validateDisplayName","name","sanitized"],"mappings":"AAGO,MAAMA,EAAiBC,GACxB,OAAOA,GAAU,SAAiB,GAE/BA,EACJ,QAAQ,QAAS,EAAE,EACnB,QAAQ,gBAAiB,EAAE,EAC3B,QAAQ,WAAY,EAAE,EACtB,OACA,UAAU,EAAG,GAAI,EAITC,EAAiBC,GACT,6BACD,KAAKA,CAAK,GAAKA,EAAM,QAAU,IAItCC,EAAoBC,GAA6D,CAC5F,MAAMC,EAAmB,CAAA,EAEzB,OAAID,EAAS,OAAS,GACpBC,EAAO,KAAK,qBAAqB,EAG/BD,EAAS,OAAS,KACpBC,EAAO,KAAK,sBAAsB,EAIhC,SAAS,KAAKD,CAAQ,GACxBC,EAAO,KAAK,kCAAmC,EAG1C,CACL,QAASA,EAAO,SAAW,EAC3B,OAAAA,CAAA,CAEJ,EAGaC,EAAuBC,GAAyD,CAC3F,MAAMF,EAAmB,CAAA,EACnBG,EAAYT,EAAcQ,CAAI,EAEpC,OAAIC,EAAU,OAAS,GACrBH,EAAO,KAAK,uBAAuB,EAGjCG,EAAU,OAAS,IACrBH,EAAO,KAAK,uBAAuB,EAGjCG,IAAcD,GAChBF,EAAO,KAAK,gCAAgC,EAGvC,CACL,QAASA,EAAO,SAAW,EAC3B,OAAAA,CAAA,CAEJ"}