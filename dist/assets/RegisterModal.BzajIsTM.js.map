{"version":3,"mappings":"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","names":["companies","RegisterModal","isOpen","onClose","onRegister","isLoading","error","email","setEmail","useState","password","setPassword","confirmPassword","setConfirmPassword","displayName","setDisplayName","company","setCompany","empl","setEmpl","base","setBase","validationError","setValidationError","displayNameRef","useRef","handleSubmit","e","sanitizedEmail","sanitizeInput","sanitizedPassword","sanitizedDisplayName","validateEmail","passwordValidation","validatePassword","nameValidation","validateDisplayName","baseCode","__vitePreload","indexedDBCache","n","handleClose","jsx","jsxs","comp","v"],"ignoreList":[],"sources":["../../components/RegisterModal.tsx"],"sourcesContent":["import React, { useState, useRef } from 'react';\nimport { validateEmail, validatePassword, validateDisplayName, sanitizeInput } from '../utils/inputValidation';\n\ninterface RegisterModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onRegister: (email: string, password: string, displayName: string, company: string, empl?: string) => void;\n  isLoading?: boolean;\n  error?: string;\n}\n\n// 회사 목록\nconst companies = [\n  { value: 'OZ', label: '아시아나항공 (OZ)' },\n  { value: 'KE', label: '대한항공 (KE)' },\n  { value: '7C', label: '제주항공 (7C)' }\n];\n\nexport default function RegisterModal({ isOpen, onClose, onRegister, isLoading = false, error }: RegisterModalProps) {\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [confirmPassword, setConfirmPassword] = useState('');\n  const [displayName, setDisplayName] = useState('');\n  const [company, setCompany] = useState('OZ'); // 기본값: 아시아나항공\n  const [empl, setEmpl] = useState('');\n  const [base, setBase] = useState('');\n  const [validationError, setValidationError] = useState('');\n  \n  // 한글 입력을 위한 ref\n  const displayNameRef = useRef<HTMLInputElement>(null);\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    setValidationError('');\n\n    // 입력값 정제 (ref에서 값 가져오기)\n    const sanitizedEmail = sanitizeInput(email);\n    const sanitizedPassword = sanitizeInput(password);\n    const sanitizedDisplayName = sanitizeInput(displayNameRef.current?.value || displayName);\n\n    // 이메일 검증\n    if (!validateEmail(sanitizedEmail)) {\n      setValidationError('올바른 이메일 주소를 입력해주세요.');\n      return;\n    }\n\n    // 비밀번호 검증\n    const passwordValidation = validatePassword(sanitizedPassword);\n    if (!passwordValidation.isValid) {\n      setValidationError(passwordValidation.errors[0]);\n      return;\n    }\n\n    if (sanitizedPassword !== confirmPassword) {\n      setValidationError('비밀번호가 일치하지 않습니다.');\n      return;\n    }\n\n    // 사용자 이름 검증\n    const nameValidation = validateDisplayName(sanitizedDisplayName);\n    if (!nameValidation.isValid) {\n      setValidationError(nameValidation.errors[0]);\n      return;\n    }\n\n    // BASE 유효성 검증 (선택 사항이지만 입력 시 3자 IATA)\n    const baseCode = base.trim().toUpperCase();\n    if (base && (!/^[A-Z]{3}$/.test(baseCode))) {\n      setValidationError('BASE는 IATA 코드(세 글자)로 입력해주세요.');\n      return;\n    }\n\n    onRegister(sanitizedEmail, sanitizedPassword, sanitizedDisplayName, company, empl);\n    // IndexedDB에 회사/베이스 선저장 (회원가입 직후 사용성이 좋도록)\n    try {\n      import('../utils/indexedDBCache').then(({ indexedDBCache }) => {\n        indexedDBCache.saveUserSettings('temp', { company, base: baseCode || undefined });\n      }).catch(() => {});\n    } catch {}\n  };\n\n  const handleClose = () => {\n    setEmail('');\n    setPassword('');\n    setConfirmPassword('');\n    setDisplayName('');\n    setCompany('OZ');\n    setEmpl('');\n    setBase('');\n    setValidationError('');\n    onClose();\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center z-50 pt-safe\" onClick={handleClose}>\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg p-8 w-full max-w-md mx-4\" onClick={(e) => e.stopPropagation()}>\n        <div className=\"flex justify-between items-center mb-6\">\n          <h2 className=\"text-2xl font-bold text-gray-900 dark:text-gray-100\">회원가입</h2>\n          <button\n            onClick={handleClose}\n            className=\"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors\"\n          >\n            <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n            </svg>\n          </button>\n        </div>\n\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\n          <div>\n            <label htmlFor=\"displayName\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n              사용자 이름 *\n            </label>\n            <input\n              ref={displayNameRef}\n              type=\"text\"\n              id=\"displayName\"\n              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n              placeholder=\"스케줄에 나오는 이름으로 적어주세요\"\n              onBlur={(e) => setDisplayName(e.target.value)}\n              onCompositionStart={(e) => {\n                  // 한글 조합 시작 시 React 상태 업데이트 방지\n                  e.currentTarget.dataset.composing = 'true';\n              }}\n              onCompositionEnd={(e) => {\n                  // 한글 조합 완료 시 React 상태 업데이트 허용\n                  e.currentTarget.dataset.composing = 'false';\n                  setDisplayName(e.currentTarget.value);\n              }}\n              onInput={(e) => {\n                  // 조합 중이 아닐 때만 상태 업데이트\n                  if (e.currentTarget.dataset.composing !== 'true') {\n                      setDisplayName(e.currentTarget.value);\n                  }\n              }}\n              required\n            />\n          </div>\n\n          <div>\n            <label htmlFor=\"company\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n              소속 회사 *\n            </label>\n            <select\n              id=\"company\"\n              value={company}\n              onChange={(e) => setCompany(e.target.value)}\n              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n              required\n            >\n              {companies.map((comp) => (\n                <option key={comp.value} value={comp.value}>\n                  {comp.label}\n                </option>\n              ))}\n            </select>\n          </div>\n\n          <div>\n            <label htmlFor=\"base\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n              BASE (IATA 코드)\n            </label>\n            <input\n              type=\"text\"\n              id=\"base\"\n              value={base}\n              onChange={(e) => {\n                const v = e.target.value.toUpperCase().replace(/[^A-Z]/g, '').slice(0,3);\n                setBase(v);\n              }}\n              maxLength={3}\n              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent uppercase\"\n              placeholder=\"IATA code로 입력해주세요 (예: ICN)\"\n            />\n          </div>\n\n          <div>\n            <label htmlFor=\"empl\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n              EMPL *\n            </label>\n            <input\n              type=\"text\"\n              id=\"empl\"\n              value={empl}\n              onChange={(e) => setEmpl(e.target.value)}\n              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n              placeholder=\"EMPL을 입력하세요\"\n              required\n            />\n          </div>\n\n          <div>\n            <label htmlFor=\"email\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n              이메일 *\n            </label>\n            <input\n              type=\"email\"\n              id=\"email\"\n              value={email}\n              onChange={(e) => setEmail(e.target.value)}\n              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n              placeholder=\"이메일을 입력하세요\"\n              required\n            />\n          </div>\n\n          <div>\n            <label htmlFor=\"password\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n              비밀번호 *\n            </label>\n            <input\n              type=\"password\"\n              id=\"password\"\n              value={password}\n              onChange={(e) => setPassword(e.target.value)}\n              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n              placeholder=\"6자 이상의 비밀번호를 입력하세요\"\n              required\n            />\n          </div>\n\n          <div>\n            <label htmlFor=\"confirmPassword\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n              비밀번호 확인 *\n            </label>\n            <input\n              type=\"password\"\n              id=\"confirmPassword\"\n              value={confirmPassword}\n              onChange={(e) => setConfirmPassword(e.target.value)}\n              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n              placeholder=\"비밀번호를 다시 입력하세요\"\n              required\n            />\n          </div>\n\n          {(validationError || error) && (\n            <div className=\"text-red-600 dark:text-red-300 text-sm bg-red-50 dark:bg-red-900 p-3 rounded-md\">\n              {validationError || error}\n            </div>\n          )}\n\n          <button\n            type=\"submit\"\n            disabled={isLoading}\n            className=\"w-full bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n          >\n            {isLoading ? (\n              <div className=\"flex items-center justify-center\">\n                <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\"></div>\n                회원가입 중...\n              </div>\n            ) : (\n              '회원가입'\n            )}\n          </button>\n        </form>\n\n        <div className=\"mt-6 text-center\">\n          <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n            이미 계정이 있으신가요?{' '}\n            <button \n              onClick={handleClose}\n              className=\"text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-500 font-medium\"\n            >\n              로그인\n            </button>\n          </p>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"file":"assets/RegisterModal.BzajIsTM.js"}