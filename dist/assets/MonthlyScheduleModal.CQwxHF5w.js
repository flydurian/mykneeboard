import{r as T,j as t,X as Z,i as f}from"./index.8oJwqbgR.js";import{g as m}from"./utils-vendor.Dc4w0XSH.js";import"./react-vendor.CdglivQu.js";import"./firebase-vendor.CQY7ULBN.js";const M=l=>({ICN:"Asia/Seoul",FCO:"Europe/Rome",TPE:"Asia/Taipei",JFK:"America/New_York",SFO:"America/Los_Angeles",LAX:"America/Los_Angeles",NRT:"Asia/Tokyo",HND:"Asia/Tokyo",LHR:"Europe/London",CDG:"Europe/Paris",FRA:"Europe/Berlin",SIN:"Asia/Singapore",HKG:"Asia/Hong_Kong",BKK:"Asia/Bangkok",KUL:"Asia/Kuala_Lumpur",MNL:"Asia/Manila",HNL:"Pacific/Honolulu",YVR:"America/Vancouver",YYZ:"America/Toronto",SYD:"Australia/Sydney",MEL:"Australia/Melbourne",AKL:"Pacific/Auckland"})[l]||"Asia/Seoul",te=({data:l,onClose:w,onFlightClick:F,onMonthChange:j,onStatusChange:k,userInfo:C})=>{const[$,D]=T.useState(!1),S=T.useRef(null),[E,A]=T.useState([]);if(T.useEffect(()=>{l&&l.flights&&A(l.flights)},[l]),!l)return null;const{month:i,flights:v,blockTime:H}=l,h=(E.length>0?E:v).reduce((r,n)=>(r.findIndex(c=>c.id===n.id)===-1&&r.push(n),r),[]).sort((r,n)=>{const o=new Date(r.date),c=new Date(n.date);if(o.getTime()!==c.getTime())return o.getTime()-c.getTime();const y=r.std||"00:00",e=n.std||"00:00",b=s=>s.includes(":")?s:s.length===4?`${s.substring(0,2)}:${s.substring(2,4)}`:s,g=b(y),U=b(e);return g.localeCompare(U)}),N=new Date,B=h.length>0?new Date(h[0].date).getFullYear():0,R=N.getFullYear()===B&&N.getMonth()===i,K=N.getFullYear()===B&&N.getMonth()>i,x=R||K,I=Intl.DateTimeFormat().resolvedOptions().timeZone||"UTC",P=m(new Date,I,"yyyy-MM-dd"),u=r=>r===P,d=h.some(r=>r.acType),O=r=>{F(r)},V=()=>{const r=i===0?11:i-1;j(r)},G=()=>{const r=i===11?0:i+1;j(r)},_=r=>{D(!0),S.current&&clearTimeout(S.current),S.current=setTimeout(()=>{D(!1)},1e3)};let L=null;try{const r=localStorage.getItem("last_upload_changed_dates");r&&(L=JSON.parse(r))}catch{}const Y=new Set(L?.dates||[]),z=r=>{if(Y.size===0)return!1;const n=r[0]?.date;return n?Y.has(n):!1};return t.jsx(t.Fragment,{children:t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex justify-center items-center z-50 p-4 pt-safe",onClick:w,children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl w-full max-w-lg md:max-w-4xl lg:max-w-5xl xl:max-w-6xl p-6 relative animate-fade-in-up flex flex-col max-h-[85vh]",onClick:r=>r.stopPropagation(),children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("h2",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:[i+1,"월 스케줄",t.jsxs("span",{className:"text-base font-medium text-gray-500 dark:text-gray-400 ml-2",children:["(총 ",H,")"]})]}),t.jsxs("div",{className:"flex items-center space-x-1",children:[t.jsx("button",{onClick:V,className:"p-1 text-gray-400 dark:text-gray-300 hover:text-gray-600 dark:hover:text-gray-100 transition-colors",title:"이전 월",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),t.jsx("button",{onClick:G,className:"p-1 text-gray-400 dark:text-gray-300 hover:text-gray-600 dark:hover:text-gray-100 transition-colors",title:"다음 월",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),t.jsx("button",{onClick:w,className:"p-1 text-gray-400 dark:text-gray-300 hover:text-gray-600 dark:hover:text-gray-100 transition-colors",title:"닫기",children:t.jsx(Z,{className:"w-5 h-5"})})]})]}),t.jsx("div",{className:`flex-grow overflow-auto ${$?"scrollbar-show":"scrollbar-hide"}`,onScroll:_,children:v.length>0?t.jsxs("table",{className:`text-center w-full ${d?"text-xs md:text-sm lg:text-base":"text-sm md:text-base"}`,children:[t.jsx("thead",{className:"text-xs font-semibold text-gray-800 dark:text-gray-300 uppercase bg-gray-50 dark:bg-gray-700 sticky top-0 z-10",children:t.jsxs("tr",{children:[t.jsx("th",{className:`${d?"px-2 py-1 md:px-3 md:py-2 lg:px-4":"px-4 py-2"} whitespace-nowrap`,children:"날짜"}),t.jsx("th",{className:`${d?"px-2 py-1 md:px-3 md:py-2 lg:px-4":"px-4 py-2"} whitespace-nowrap`,children:"편명"}),t.jsx("th",{className:`${d?"px-2 py-1 md:px-3 md:py-2 lg:px-4":"px-4 py-2"} whitespace-nowrap`,children:"노선"}),d&&t.jsx("th",{className:"px-2 py-1 md:px-3 md:py-2 lg:px-4",children:t.jsxs("div",{className:"text-xs md:text-sm",children:[t.jsx("div",{children:"A/C"}),t.jsx("div",{children:"TYPE"})]})}),t.jsx("th",{className:"px-4 py-2 md:px-3 md:py-2 lg:px-4 whitespace-nowrap hidden md:table-cell",children:"SHOW UP"}),t.jsx("th",{className:"px-4 py-2 md:px-3 md:py-2 lg:px-4 whitespace-nowrap hidden md:table-cell",children:"STD"}),t.jsx("th",{className:"px-4 py-2 md:px-3 md:py-2 lg:px-4 whitespace-nowrap hidden md:table-cell",children:"STA"}),x&&t.jsx("th",{className:"px-4 py-2 md:px-3 md:py-2 lg:px-4 whitespace-nowrap hidden md:table-cell",children:"이착륙"})]})}),t.jsx("tbody",{children:(()=>{const r={};h.forEach(o=>{r[o.date]||(r[o.date]=[]),r[o.date].push(o)});const n=[];return Object.keys(r).forEach(o=>{const c=r[o],y=z(c);c.forEach((e,b)=>{const g=b===0,U=g?c.length:void 0;n.push(t.jsxs("tr",{className:`border-b dark:border-gray-700 cursor-pointer ${u(e.date)?"relative":""}`,onClick:()=>O(e),children:[g&&t.jsxs("td",{rowSpan:U,className:`${d?"px-2 py-2 md:px-3 md:py-3 lg:px-4":"px-4 py-3"} font-medium text-gray-900 dark:text-gray-200 whitespace-nowrap relative ${y?"border-l-4 border-green-500":"border-l-4 border-transparent"}`,children:[u(e.date)&&t.jsx("span",{className:"absolute left-0 top-0 bottom-0 w-1 bg-fuchsia-500","aria-hidden":!0}),e.date.substring(5)]}),t.jsx("td",{className:`${d?"px-2 py-2 md:px-3 md:py-3 lg:px-4":"px-4 py-3"} text-gray-900 dark:text-gray-200 max-w-[100px] break-words`,children:e.flightNumber}),t.jsx("td",{className:`${d?"px-2 py-2 md:px-3 md:py-3 lg:px-4":"px-4 py-3"} text-gray-900 dark:text-gray-200 max-w-[120px] break-words ${u(e.date)&&!d&&!x?"border-r-4 border-fuchsia-500":""}`,children:f(e)?e.route?.replace("/"," → "):e.flightNumber==="OTHRDUTY"||e.flightNumber==="HM SBY"||e.flightNumber==="STBY"?e.route:(e.flightNumber==="RESERVE"||e.flightNumber==="ALV"||e.flightNumber==="ALM","")}),d&&t.jsx("td",{className:`px-2 py-2 md:px-3 md:py-3 lg:px-4 text-gray-900 dark:text-gray-200 text-center ${u(e.date)&&!x?"border-r-4 border-fuchsia-500":""}`,children:e.acType||""}),t.jsx("td",{className:"px-4 py-3 md:px-3 md:py-3 lg:px-4 text-gray-900 dark:text-gray-200 whitespace-nowrap hidden md:table-cell",children:e.flightNumber.toUpperCase().includes("G/S STUDENT")||e.flightNumber.toUpperCase().includes("GS STUDENT")||e.flightNumber.toUpperCase().includes("STBY")||e.flightNumber.toUpperCase().includes("RESERVE")||e.flightNumber.toUpperCase().includes("FIXED SKD")?"":e.showUpDateTimeUtc?m(new Date(e.showUpDateTimeUtc),"Asia/Seoul","HH:mm"):""}),t.jsx("td",{className:"px-4 py-3 md:px-3 md:py-3 lg:px-4 text-gray-900 dark:text-gray-200 whitespace-nowrap hidden md:table-cell",children:e.flightNumber.toUpperCase().includes("G/S STUDENT")||e.flightNumber.toUpperCase().includes("GS STUDENT")||e.flightNumber.toUpperCase().includes("STBY")&&!e.flightNumber.includes("A STBY")&&!e.flightNumber.includes("B STBY")||e.flightNumber.toUpperCase().includes("RESERVE")||e.flightNumber.toUpperCase().includes("FIXED SKD")||e.flightNumber.toUpperCase().includes("ANNUAL LEAVE")||e.flightNumber.toUpperCase().includes("ALV")||e.flightNumber.toUpperCase().includes("ALM")||e.flightNumber.toUpperCase().includes("MEDICAL CHK")||e.flightNumber.toUpperCase().includes("MEDICAL")||e.flightNumber.toUpperCase().includes("ORAL")||e.flightNumber.toUpperCase().includes("안전회의")||e.flightNumber.toUpperCase().includes("SAFETY")?e.flightNumber==="A STBY"?"04:00":e.flightNumber==="B STBY"?"09:00":"":e.flightNumber==="A STBY"||e.flightNumber==="B STBY"?C?.company==="OZ"?e.flightNumber==="A STBY"?"04:00":"09:00":e.departureDateTimeUtc?(()=>{const s=new Date(e.departureDateTimeUtc);return m(s,"Asia/Seoul","HH:mm")})():e.flightNumber==="A STBY"?"04:00":"09:00":e.departureDateTimeUtc&&e.route?(()=>{const s=new Date(e.departureDateTimeUtc),p=e.route.split("/")[0],a=M(p);return m(s,a,"HH:mm")})():""}),t.jsx("td",{className:`px-4 py-3 md:px-3 md:py-3 lg:px-4 text-gray-900 dark:text-gray-200 whitespace-nowrap hidden md:table-cell ${u(e.date)&&!x?"border-r-4 border-fuchsia-500":""}`,children:e.flightNumber.toUpperCase().includes("G/S STUDENT")||e.flightNumber.toUpperCase().includes("GS STUDENT")||e.flightNumber.toUpperCase().includes("STBY")&&!e.flightNumber.includes("A STBY")&&!e.flightNumber.includes("B STBY")||e.flightNumber.toUpperCase().includes("RESERVE")||e.flightNumber.toUpperCase().includes("FIXED SKD")||e.flightNumber.toUpperCase().includes("ANNUAL LEAVE")||e.flightNumber.toUpperCase().includes("ALV")||e.flightNumber.toUpperCase().includes("ALM")||e.flightNumber.toUpperCase().includes("MEDICAL CHK")||e.flightNumber.toUpperCase().includes("MEDICAL")||e.flightNumber.toUpperCase().includes("ORAL")||e.flightNumber.toUpperCase().includes("안전회의")||e.flightNumber.toUpperCase().includes("SAFETY")?e.flightNumber==="A STBY"?"16:00":e.flightNumber==="B STBY"?"21:00":"":e.flightNumber==="A STBY"||e.flightNumber==="B STBY"?C?.company==="OZ"?e.flightNumber==="A STBY"?"16:00":"21:00":e.arrivalDateTimeUtc?(()=>{const s=new Date(e.arrivalDateTimeUtc);return m(s,"Asia/Seoul","HH:mm")})():e.flightNumber==="A STBY"?"16:00":"21:00":e.arrivalDateTimeUtc&&e.route?(()=>{const s=new Date(e.arrivalDateTimeUtc),p=e.route.split("/")[1],a=M(p);return m(s,a,"HH:mm")})():""}),x&&t.jsx("td",{className:`px-4 py-3 md:px-3 md:py-3 lg:px-4 whitespace-nowrap hidden md:table-cell ${u(e.date)?"border-r-4 border-fuchsia-500":""}`,children:f(e)&&e.route&&t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsx("button",{onClick:s=>{s.stopPropagation(),A(p=>p.map(a=>a.id===e.id?{...a,status:{...a.status,departed:!a.status?.departed}}:a)),k?.(e.id,{departed:!e.status?.departed})},title:"이륙 완료",className:`w-5 h-5 rounded-full flex items-center justify-center text-xs font-bold text-white transition-colors cursor-pointer ${e.status?.departed?"bg-blue-500 hover:bg-blue-600":"bg-gray-300 dark:bg-gray-600 hover:bg-blue-400 dark:hover:bg-blue-500"}`,children:"T"}),t.jsx("button",{onClick:s=>{s.stopPropagation(),A(p=>p.map(a=>a.id===e.id?{...a,status:{...a.status,landed:!a.status?.landed}}:a)),k?.(e.id,{landed:!e.status?.landed})},title:"착륙 완료",className:`w-5 h-5 rounded-full flex items-center justify-center text-xs font-bold text-white transition-colors cursor-pointer ${e.status?.landed?"bg-green-500 hover:bg-green-600":"bg-gray-300 dark:bg-gray-600 hover:bg-green-400 dark:hover:bg-green-500"}`,children:"L"})]})})]},`${e.id}-${o}-${b}`))})}),n})()})]}):t.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center py-8",children:"해당 월의 스케줄이 없습니다."})})]})})})};export{te as default};
//# sourceMappingURL=MonthlyScheduleModal.CQwxHF5w.js.map
